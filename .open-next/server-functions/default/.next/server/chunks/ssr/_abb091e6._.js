module.exports=[62067,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=(0,c.forwardRef)(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("glass rounded-2xl p-6 transition-all duration-300",a),...c}));e.displayName="Card",a.s(["Card",0,e])},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},96438,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114),e=a.i(96221);let f=(0,c.forwardRef)(({className:a,variant:c="primary",size:f="md",isLoading:g,children:h,disabled:i,...j},k)=>(0,b.jsxs)("button",{ref:k,className:(0,d.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[c],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[f],a),disabled:i||g,...j,children:[g&&(0,b.jsx)(e.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),h]}));f.displayName="Button",a.s(["Button",0,f])},55486,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=(0,c.forwardRef)(({className:a,variant:c="default",...e},f)=>(0,b.jsx)("span",{ref:f,className:(0,d.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[c],a),...e}));e.displayName="Badge",a.s(["Badge",0,e])},41675,a=>{"use strict";let b=(0,a.i(70106).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},38894,63588,a=>{"use strict";var b=a.i(20237);a.i(69387);var c=a.i(60574);let d=new class{async createReport(a,d,e,f,g,h){try{return(await (0,c.addDoc)((0,c.collection)(b.db,"dailyReports"),{matchId:d,studentId:a,date:c.Timestamp.fromDate(h),content:e,learning:f,nextGoals:g,createdAt:(0,c.serverTimestamp)(),updatedAt:(0,c.serverTimestamp)()})).id}catch(a){throw console.error("createReport error:",a),a}}async getReports(a){try{let d=(0,c.query)((0,c.collection)(b.db,"dailyReports"),(0,c.where)("matchId","==",a),(0,c.orderBy)("date","desc"));return(await (0,c.getDocs)(d)).docs.map(a=>({id:a.id,...a.data()}))}catch(a){throw console.error("getReports error:",a),a}}async addCompanyComment(a,d){try{let e=(0,c.doc)(b.db,"dailyReports",a);await (0,c.updateDoc)(e,{companyComment:d,updatedAt:(0,c.serverTimestamp)()})}catch(a){throw console.error("addCompanyComment error:",a),a}}async getMatch(a){try{let d=await (0,c.getDoc)((0,c.doc)(b.db,"matches",a));if(d.exists())return{id:d.id,...d.data()};return null}catch(a){throw console.error("getMatch error:",a),a}}async completeInternship(a){try{await (0,c.updateDoc)((0,c.doc)(b.db,"matches",a),{status:"completed",endDate:(0,c.serverTimestamp)()})}catch(a){throw console.error("completeInternship error:",a),a}}async submitEvaluation(a,d,e,f,g){try{await (0,c.addDoc)((0,c.collection)(b.db,"evaluations"),{matchId:a,fromId:d,toId:e,score:f,comment:g,createdAt:(0,c.serverTimestamp)()})}catch(a){throw console.error("submitEvaluation error:",a),a}}async getEvaluation(a,d){try{let e=(0,c.query)((0,c.collection)(b.db,"evaluations"),(0,c.where)("matchId","==",a),(0,c.where)("fromId","==",d)),f=await (0,c.getDocs)(e);if(!f.empty)return{id:f.docs[0].id,...f.docs[0].data()};return null}catch(a){throw console.error("getEvaluation error:",a),a}}};a.s(["internshipService",0,d],38894);let e=(0,a.i(70106).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);a.s(["MessageSquare",()=>e],63588)},73171,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11642),e=a.i(38894);a.i(69387);var f=a.i(60574),g=a.i(20237),h=a.i(62067),i=a.i(96438),j=a.i(55486),k=a.i(96221),l=a.i(41675),m=a.i(16201),n=a.i(63588),o=a.i(56711);function p({params:a}){let{matchId:p}=(0,c.use)(a),{user:q}=(0,d.useAuth)(),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(0),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(!1);(0,c.useEffect)(()=>{!async function(){if(q)try{let a=await e.internshipService.getMatch(p);if(!a||a.companyId!==q.id)throw Error("Match not found or unauthorized");s(a);let b=await (0,f.getDoc)((0,f.doc)(g.db,"students",a.studentId));b.exists()?u(b.data()):u({name:"Unknown",userId:a.studentId});let c=await e.internshipService.getReports(p);if(w(c),"completed"===a.status){let a=await e.internshipService.getEvaluation(p,q.id);A(a)}}catch(a){console.error("Error fetching data:",a)}finally{y(!1)}}()},[p,q]);let N=async()=>{if(r&&confirm("このインターンシップを終了しますか？\n終了すると、学生への評価が可能になります。"))try{await e.internshipService.completeInternship(r.id);let a=await e.internshipService.getMatch(r.id);s(a)}catch(a){console.error(a),alert("ステータス更新に失敗しました")}},O=async a=>{if(J){M(!0);try{if(await e.internshipService.addCompanyComment(a,J),r){let a=await e.internshipService.getReports(r.id);w(a)}I(null),K("")}catch(a){console.error(a),alert("コメントの送信に失敗しました")}finally{M(!1)}}},P=async a=>{if((a.preventDefault(),q&&r&&t)&&confirm("評価を送信しますか？送信後は変更できません。")){G(!0);try{await e.internshipService.submitEvaluation(r.id,q.id,t.userId,B,D);let a=await e.internshipService.getEvaluation(r.id,q.id);A(a)}catch(a){console.error(a),alert("評価の送信に失敗しました")}finally{G(!1)}}};return x?(0,b.jsx)("div",{className:"flex justify-center p-12",children:(0,b.jsx)(k.Loader2,{className:"animate-spin"})}):r?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center bg-[#1E3A5F] text-white p-6 rounded-xl shadow-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h1",{className:"text-xl font-bold",children:t?.name}),(0,b.jsx)("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded",children:t?.university})]}),(0,b.jsxs)("p",{className:"text-sm opacity-90",children:["期間: ",r.startDate?(0,o.format)(r.startDate.toDate(),"yyyy/MM/dd"):"-",r.endDate?` ~ ${(0,o.format)(r.endDate.toDate(),"yyyy/MM/dd")}`:" ~ 進行中"]})]}),(0,b.jsx)("div",{children:"active"===r.status?(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(j.Badge,{variant:"success",className:"bg-[#48BB78] text-white border-none",children:"進行中"}),(0,b.jsxs)(i.Button,{size:"sm",className:"bg-white text-[#1E3A5F] hover:bg-white/90",onClick:N,children:[(0,b.jsx)(m.CheckCircle,{size:16,className:"mr-1"}),"インターンを終了する"]})]}):(0,b.jsx)(j.Badge,{variant:"outline",className:"text-white border-white",children:"完了"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center",children:(0,b.jsx)("h2",{className:"text-lg font-bold text-[#1E3A5F]",children:"日報一覧"})}),0===v.length?(0,b.jsx)(h.Card,{className:"p-8 text-center text-gray-500",children:"まだ日報が提出されていません。"}):(0,b.jsx)("div",{className:"space-y-4",children:v.map(a=>(0,b.jsxs)(h.Card,{className:"p-5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3 border-b pb-2",children:[(0,b.jsx)(l.Calendar,{size:16,className:"text-gray-400"}),(0,b.jsx)("span",{className:"font-bold text-[#1E3A5F]",children:(0,o.format)(a.date.toDate(),"yyyy/MM/dd")})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-gray-400 block",children:"業務内容"}),(0,b.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:a.content})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-gray-400 block",children:"学んだこと"}),(0,b.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:a.learning})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-gray-400 block",children:"明日の目標"}),(0,b.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:a.nextGoals})]}),(0,b.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg mt-2 border border-gray-100",children:a.companyComment?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-blue-800 font-bold mb-1 text-xs",children:[(0,b.jsx)(n.MessageSquare,{size:12}),"フィードバック済み"]}),(0,b.jsx)("p",{className:"text-sm text-blue-900",children:a.companyComment})]}):H===a.id?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("textarea",{className:"w-full text-sm border rounded p-2",value:J,onChange:a=>K(a.target.value),placeholder:"フィードバックを入力..."}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(i.Button,{size:"sm",variant:"secondary",onClick:()=>I(null),children:"キャンセル"}),(0,b.jsx)(i.Button,{size:"sm",onClick:()=>O(a.id),isLoading:L,children:"送信"})]})]}):(0,b.jsx)(i.Button,{size:"sm",variant:"outline",className:"w-full text-xs text-gray-500 hover:text-[#1E3A5F]",onClick:()=>{I(a.id),K("")},children:"+ フィードバックを書く"})})]})]},a.id))})]}),(0,b.jsx)("div",{className:"space-y-6",children:"completed"===r.status&&(0,b.jsxs)(h.Card,{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-bold mb-4 text-[#1E3A5F]",children:"学生評価"}),z?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-[#48BB78]/10 text-center py-4 rounded-lg",children:[(0,b.jsx)("span",{className:"block text-xs text-gray-500",children:"評価完了"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-[#2F855A]",children:"送信済み"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-gray-400",children:"スコア"}),(0,b.jsx)("div",{className:"flex text-yellow-500",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("span",{className:c<z.score?"text-yellow-500":"text-gray-300",children:"★"},c))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-gray-400",children:"コメント"}),(0,b.jsx)("p",{className:"text-sm",children:z.comment})]})]}):(0,b.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"インターンシップが終了しました。 学生への最終評価を入力してください。"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"評価スコア (1-5)"}),(0,b.jsxs)("select",{className:"w-full border rounded p-2",value:B,onChange:a=>C(Number(a.target.value)),required:!0,children:[(0,b.jsx)("option",{value:"0",children:"選択してください"}),(0,b.jsx)("option",{value:"5",children:"5 - 非常に優秀"}),(0,b.jsx)("option",{value:"4",children:"4 - 優秀"}),(0,b.jsx)("option",{value:"3",children:"3 - 標準的"}),(0,b.jsx)("option",{value:"2",children:"2 - 改善の余地あり"}),(0,b.jsx)("option",{value:"1",children:"1 - 期待を下回る"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-1",children:"コメント"}),(0,b.jsx)("textarea",{className:"w-full border rounded p-2 min-h-[100px]",value:D,onChange:a=>E(a.target.value),required:!0,placeholder:"学生へのフィードバックや応援メッセージ..."})]}),(0,b.jsx)(i.Button,{type:"submit",className:"w-full",isLoading:F,disabled:0===B,children:"評価を送信する"})]})]})})]})]}):(0,b.jsx)("div",{className:"p-12 text-center",children:"データが見つかりません"})}a.s(["default",()=>p])}];

//# sourceMappingURL=_abb091e6._.js.map