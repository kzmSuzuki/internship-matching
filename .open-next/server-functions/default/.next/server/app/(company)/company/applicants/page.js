(()=>{var e={};e.id=639,e.ids=[639],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},55020:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>o,routeModule:()=>m,tree:()=>c}),s(73400),s(1360),s(90996),s(15539);var a=s(30170),r=s(45002),n=s(83876),i=s.n(n),d=s(66299),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(t,l);let c=["",{children:["(company)",{children:["company",{children:["applicants",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,73400)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(company)/company/applicants/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,1360)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(company)/company/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,15539)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(company)/company/applicants/page.tsx"],p="/(company)/company/applicants/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(company)/company/applicants/page",pathname:"/company/applicants",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54026:(e,t,s)=>{Promise.resolve().then(s.bind(s,67842))},17085:(e,t,s)=>{Promise.resolve().then(s.bind(s,37605))},67842:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(97247),r=s(28964);s(62216),s(94082);var n=s(222),i=s(17596),d=s(55039),l=s(76219),c=s(4193),o=s(8749),p=s(42310),u=s(8553),m=s(34178),x=s(68170);function h(){let{user:e}=(0,n.a)(),t=(0,m.useRouter)(),[s,h]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),[b,f]=(0,r.useState)(null),[v,j]=(0,r.useState)(null),w=async(t,s)=>{if(e&&confirm("pending_student"===s?"この学生にマッチングオファーを出しますか？":"本当に不採用にしますか？")){f(t);try{"pending_student"===s?await x.v.approveByCompany(t,e.id):"rejected_by_company"===s&&await x.v.rejectByCompany(t,e.id),h(e=>e.map(e=>e.id===t?{...e,status:s}:e)),j(null)}catch(e){console.error("Error updating status:",e),alert("ステータス更新に失敗しました: "+e.message)}finally{f(null)}}};return g?a.jsx("div",{className:"flex justify-center p-12",children:a.jsx(o.Z,{className:"animate-spin"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#1E3A5F]",children:"応募者管理"}),a.jsx("p",{className:"text-gray-500",children:"求人への応募者を確認し、選考を進めましょう"})]}),0===s.length?a.jsx(i.Z,{className:"p-12 text-center text-gray-500",children:a.jsx("p",{children:"現在、応募者はいません。"})}):a.jsx("div",{className:"grid gap-4",children:s.map(e=>a.jsx(i.Z,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-bold text-[#1E3A5F]",children:e.student.name}),a.jsx(l.C,{variant:"outline",className:"text-xs",children:e.student.university||"大学未設定"}),a.jsx("span",{className:"text-xs text-gray-400",children:e.student.grade})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[a.jsx(p.Z,{size:14}),(0,a.jsxs)("span",{children:["応募先: ",e.job.title]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:["pending_admin"===e.status&&a.jsx(l.C,{variant:"warning",children:"管理者承認待ち"}),"pending_company"===e.status&&a.jsx(l.C,{variant:"warning",className:"animate-pulse",children:"対応待ち"}),"pending_student"===e.status&&a.jsx(l.C,{variant:"success",children:"オファー済み"}),"matched"===e.status&&a.jsx(l.C,{variant:"success",className:"bg-green-600 text-white",children:"マッチング成立"}),e.status.includes("rejected")&&a.jsx(l.C,{variant:"error",className:"bg-gray-100 text-gray-500",children:"不採用"})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["応募日: ",(0,u.WU)(e.createdAt.toDate(),"yyyy/MM/dd HH:mm")]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(d.z,{variant:"outline",onClick:()=>j(e),children:"詳細・プロフィール"}),"pending_company"===e.status&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(d.z,{onClick:()=>w(e.id,"pending_student"),isLoading:b===e.id,className:"bg-[#48BB78] hover:bg-[#48BB78]/90",children:"オファー承認"}),a.jsx(d.z,{variant:"danger",className:"bg-red-50 text-red-600 hover:bg-red-100 border-red-200",onClick:()=>w(e.id,"rejected_by_company"),disabled:!!b,children:"不採用"})]}),("matched"===e.status||"completed"===e.status)&&e.matchId&&a.jsx("div",{className:"ml-2",children:a.jsx(d.z,{variant:"outline",className:"bg-[#1E3A5F]/5 border-[#1E3A5F]/20 text-[#1E3A5F]",onClick:()=>t.push(`/company/intern/${e.matchId}`),children:"インターン管理画面へ"})})]})]})},e.id))}),a.jsx(c.u,{isOpen:!!v,onClose:()=>j(null),title:"応募者詳細",children:v&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"氏名"}),a.jsx("p",{className:"font-medium text-lg",children:v.student.name})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"所属"}),(0,a.jsxs)("p",{children:[v.student.university," ",v.student.grade]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"自己PR / BIO"}),a.jsx("div",{className:"bg-gray-50 p-3 rounded-lg text-sm whitespace-pre-wrap",children:v.student.bio||"未入力"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"スキル"}),a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:v.student.skills?.map((e,t)=>a.jsx(l.C,{variant:"outline",className:"text-xs",children:e},t))})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs text-gray-500",children:"ポートフォリオ / リンク"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-blue-600",children:v.student.links?.map((e,t)=>a.jsx("li",{children:a.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:e})},t))})]}),(0,a.jsxs)("div",{className:"border-t pt-4 mt-4",children:[a.jsx("label",{className:"text-xs text-gray-500",children:"応募メッセージ"}),a.jsx("p",{className:"text-sm mt-1",children:v.message})]}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsx(d.z,{variant:"secondary",onClick:()=>j(null),children:"閉じる"})})]})})]})}},37605:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(97247),r=s(59574);function n({children:e}){return a.jsx(r.Z,{children:e})}},76219:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var a=s(97247),r=s(28964),n=s(40677);let i=(0,r.forwardRef)(({className:e,variant:t="default",...s},r)=>a.jsx("span",{ref:r,className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[t],e),...s}));i.displayName="Badge"},55039:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var a=s(97247),r=s(28964),n=s(40677),i=s(8749);let d=(0,r.forwardRef)(({className:e,variant:t="primary",size:s="md",isLoading:r,children:d,disabled:l,...c},o)=>(0,a.jsxs)("button",{ref:o,className:(0,n.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[s],e),disabled:l||r,...c,children:[r&&a.jsx(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}),d]}));d.displayName="Button"},4193:(e,t,s)=>{"use strict";s.d(t,{u:()=>d});var a=s(97247);s(28964);var r=s(46817);let n=(0,s(9148).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var i=s(40677);function d({isOpen:e,onClose:t,title:s,children:d,className:l}){return e?(0,r.createPortal)(a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:(0,a.jsxs)("div",{className:(0,i.cn)("relative w-full max-w-lg transform rounded-2xl bg-white/80 backdrop-blur-2xl p-6 text-left align-middle shadow-2xl transition-all animate-in zoom-in-95 duration-200 border border-white/40",l),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[s&&a.jsx("h3",{className:"text-lg font-medium leading-6 text-[#161B33]",children:s}),a.jsx("button",{onClick:t,className:"rounded-full p-1 hover:bg-gray-100 transition-colors",children:a.jsx(n,{className:"h-5 w-5 text-gray-500"})})]}),a.jsx("div",{children:d})]})}),document.body):null}},68170:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});var a=s(94082),r=s(62216);class n{async applyJob(e,t,s,n=""){try{return await (0,r.i3)(a.db,async i=>{let d=(0,r.hJ)(a.db,"applications"),l=(0,r.IO)(d,(0,r.ar)("studentId","==",e),(0,r.ar)("status","in",["pending_admin","pending_company","pending_student","matched"]));if(!(await (0,r.PL)(l)).empty)throw Error("Already have an active application");let c=(0,r.JU)((0,r.hJ)(a.db,"applications")),o={jobId:t,studentId:e,companyId:s,status:"pending_admin",message:n,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()},p=(0,r.JU)((0,r.hJ)(a.db,"notifications")),u={userId:"admin",type:"job_applied",title:"新規応募がありました",message:`求人ID: ${t} に新しい応募があります。`,link:`/admin/applications/${c.id}`,read:!1,createdAt:(0,r.Bt)()};return i.set(c,o),i.set(p,u),c.id})}catch(e){throw console.error("MatchingService.applyJob error:",e),e}}async acceptMatchByStudent(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.studentId!==t)throw Error("Unauthorized");if("pending_student"!==d.status)throw Error("Invalid status");s.update(n,{status:"matched",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"matches")),c={applicationId:e,jobId:d.jobId,studentId:d.studentId,companyId:d.companyId,status:"active",startDate:(0,r.Bt)(),createdAt:(0,r.Bt)()};s.set(l,c),s.update(n,{matchId:l.id});let o=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(o,{userId:d.companyId,type:"offer_accepted",title:"マッチング成立！",message:"学生がオファーを承諾しました。インターンシップの準備を始めましょう。",link:`/company/intern/${l.id}`,read:!1,createdAt:(0,r.Bt)()})})}async approveByCompany(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.companyId!==t)throw Error("Unauthorized");if("pending_company"!==d.status)throw Error("Invalid status (Must be pending_company)");s.update(n,{status:"pending_student",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(l,{userId:d.studentId,type:"offer_received",title:"マッチングオファーが届きました！",message:"企業があなたの応募に関心を持っています。オファーを確認してください。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async rejectByCompany(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.companyId!==t)throw Error("Unauthorized");s.update(n,{status:"rejected_by_company",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(l,{userId:d.studentId,type:"offer_rejected",title:"選考結果のお知らせ",message:"残念ながら今回の応募は見送られました。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async approveByAdmin(e){await (0,r.i3)(a.db,async t=>{let s=(0,r.JU)(a.db,"applications",e),n=await t.get(s);if(!n.exists())throw Error("Application not found");let i=n.data();if("pending_admin"!==i.status)throw Error("Invalid status");t.update(s,{status:"pending_company",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"notifications"));t.set(d,{userId:i.companyId,type:"application_approved_admin",title:"新しい応募が届きました",message:"管理者承認済みの応募があります。内容を確認してください。",link:"/company/applicants",read:!1,createdAt:(0,r.Bt)()})})}}let i=new n},73400:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(company)/company/applicants/page.tsx#default`)},1360:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(company)/company/layout.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[379,499,331,906,106,812,553,93],()=>s(55020));module.exports=a})();