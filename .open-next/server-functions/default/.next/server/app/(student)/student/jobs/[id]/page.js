(()=>{var e={};e.id=422,e.ids=[422],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},70837:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>o,routeModule:()=>x,tree:()=>c}),s(45877),s(52052),s(90996),s(15539);var a=s(30170),r=s(45002),i=s(83876),n=s.n(i),d=s(66299),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);s.d(t,l);let c=["",{children:["(student)",{children:["student",{children:["jobs",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,45877)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,52052)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,15539)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx"],p="/(student)/student/jobs/[id]/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(student)/student/jobs/[id]/page",pathname:"/student/jobs/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9970:(e,t,s)=>{Promise.resolve().then(s.bind(s,87506))},17020:(e,t,s)=>{Promise.resolve().then(s.bind(s,64405))},77256:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]])},50820:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9527:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},87506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(97247),r=s(28964);s(62216),s(94082);var i=s(222),n=s(55039),d=s(17596),l=s(76219),c=s(8749),o=s(77256),p=s(9527),u=s(50820),x=s(20290),h=s(8553),m=s(34178),y=s(68170);function g({params:e}){let{id:t}=(0,r.use)(e),{user:s}=(0,i.a)(),[g,f]=(0,r.useState)(null),[b,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(!0),[k,N]=(0,r.useState)(!1),[_,A]=(0,r.useState)(null),[E,I]=(0,r.useState)(null),q=(0,m.useRouter)(),B=async()=>{if(s&&g){if(_&&["pending_admin","pending_company","pending_student","matched"].includes(_.status)){alert("既に応募中の求人があります。新たな応募はできません。");return}if(confirm("この求人に応募しますか？\n※同時に応募できるのは1件のみです。")){N(!0);try{await y.v.applyJob(s.id,g.id,g.companyId,"応募しました"),q.push("/student/applications")}catch(e){console.error("Error applying:",e),alert("応募に失敗しました: "+e.message)}finally{N(!1)}}}};if(j)return a.jsx("div",{className:"flex justify-center p-12",children:a.jsx(c.Z,{className:"animate-spin"})});if(!g)return a.jsx("div",{className:"text-center p-12",children:"求人が見つかりません"});let P=_?.jobId===g.id,J=!!_;return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsx(d.Z,{className:"p-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#1E3A5F] mb-2",children:g.title}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-gray-600 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(o.Z,{size:16}),a.jsx("span",{children:b?.name||"企業名不明"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(p.Z,{size:16}),a.jsx("span",{children:g.location})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(u.Z,{size:16}),a.jsx("span",{children:g.createdAt?(0,h.WU)(g.createdAt.toDate(),"yyyy/MM/dd"):"-"})]})]}),a.jsx("div",{className:"flex gap-2",children:g.requirements.map((e,t)=>a.jsx(l.C,{variant:"outline",className:"bg-gray-50",children:e},t))})]}),a.jsx("div",{className:"md:text-right",children:J?(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2 text-warning-600",children:[P?a.jsx(l.C,{variant:"success",className:"text-lg px-4 py-2",children:"応募済み"}):a.jsx(l.C,{variant:"warning",className:"text-lg px-4 py-2 opacity-50 cursor-not-allowed",children:"他の求人に応募中"}),a.jsx("span",{className:"text-xs text-gray-500",children:"※同時に応募できるのは1件のみです"})]}):a.jsx(n.z,{size:"lg",onClick:B,isLoading:k,children:"この求人に応募する"})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"md:col-span-2 space-y-6",children:(0,a.jsxs)(d.Z,{className:"p-6",children:[a.jsx("h2",{className:"text-lg font-bold mb-4 border-b pb-2",children:"募集要項 (PDF)"}),E?a.jsx("div",{className:"aspect-[1/1.4] w-full bg-gray-100 rounded-lg flex items-center justify-center border",children:a.jsx("iframe",{src:E,className:"w-full h-full rounded-lg",title:"Job PDF"})}):(0,a.jsxs)("div",{className:"aspect-[1/1.4] w-full bg-gray-50 rounded-lg flex flex-col items-center justify-center text-gray-400",children:[a.jsx(x.Z,{size:48,className:"mb-2"}),a.jsx("p",{children:"PDFファイルがありません"})]})]})}),a.jsx("div",{className:"space-y-6",children:(0,a.jsxs)(d.Z,{className:"p-6",children:[a.jsx("h2",{className:"text-lg font-bold mb-4",children:"企業情報"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"業界"}),a.jsx("p",{children:b?.industry||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"住所"}),a.jsx("p",{children:b?.address||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"Webサイト"}),a.jsx("a",{href:b?.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate block",children:b?.website||"-"})]})]})]})})]})]})}},64405:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(97247),r=s(59574);function i({children:e}){return a.jsx(r.Z,{children:e})}},76219:(e,t,s)=>{"use strict";s.d(t,{C:()=>n});var a=s(97247),r=s(28964),i=s(40677);let n=(0,r.forwardRef)(({className:e,variant:t="default",...s},r)=>a.jsx("span",{ref:r,className:(0,i.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[t],e),...s}));n.displayName="Badge"},55039:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var a=s(97247),r=s(28964),i=s(40677),n=s(8749);let d=(0,r.forwardRef)(({className:e,variant:t="primary",size:s="md",isLoading:r,children:d,disabled:l,...c},o)=>(0,a.jsxs)("button",{ref:o,className:(0,i.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[s],e),disabled:l||r,...c,children:[r&&a.jsx(n.Z,{className:"mr-2 h-4 w-4 animate-spin"}),d]}));d.displayName="Button"},68170:(e,t,s)=>{"use strict";s.d(t,{v:()=>n});var a=s(94082),r=s(62216);class i{async applyJob(e,t,s,i=""){try{return await (0,r.i3)(a.db,async n=>{let d=(0,r.hJ)(a.db,"applications"),l=(0,r.IO)(d,(0,r.ar)("studentId","==",e),(0,r.ar)("status","in",["pending_admin","pending_company","pending_student","matched"]));if(!(await (0,r.PL)(l)).empty)throw Error("Already have an active application");let c=(0,r.JU)((0,r.hJ)(a.db,"applications")),o={jobId:t,studentId:e,companyId:s,status:"pending_admin",message:i,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()},p=(0,r.JU)((0,r.hJ)(a.db,"notifications")),u={userId:"admin",type:"job_applied",title:"新規応募がありました",message:`求人ID: ${t} に新しい応募があります。`,link:`/admin/applications/${c.id}`,read:!1,createdAt:(0,r.Bt)()};return n.set(c,o),n.set(p,u),c.id})}catch(e){throw console.error("MatchingService.applyJob error:",e),e}}async acceptMatchByStudent(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let d=n.data();if(d.studentId!==t)throw Error("Unauthorized");if("pending_student"!==d.status)throw Error("Invalid status");s.update(i,{status:"matched",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"matches")),c={applicationId:e,jobId:d.jobId,studentId:d.studentId,companyId:d.companyId,status:"active",startDate:(0,r.Bt)(),createdAt:(0,r.Bt)()};s.set(l,c),s.update(i,{matchId:l.id});let o=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(o,{userId:d.companyId,type:"offer_accepted",title:"マッチング成立！",message:"学生がオファーを承諾しました。インターンシップの準備を始めましょう。",link:`/company/intern/${l.id}`,read:!1,createdAt:(0,r.Bt)()})})}async approveByCompany(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let d=n.data();if(d.companyId!==t)throw Error("Unauthorized");if("pending_company"!==d.status)throw Error("Invalid status (Must be pending_company)");s.update(i,{status:"pending_student",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(l,{userId:d.studentId,type:"offer_received",title:"マッチングオファーが届きました！",message:"企業があなたの応募に関心を持っています。オファーを確認してください。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async rejectByCompany(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let d=n.data();if(d.companyId!==t)throw Error("Unauthorized");s.update(i,{status:"rejected_by_company",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(l,{userId:d.studentId,type:"offer_rejected",title:"選考結果のお知らせ",message:"残念ながら今回の応募は見送られました。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async approveByAdmin(e){await (0,r.i3)(a.db,async t=>{let s=(0,r.JU)(a.db,"applications",e),i=await t.get(s);if(!i.exists())throw Error("Application not found");let n=i.data();if("pending_admin"!==n.status)throw Error("Invalid status");t.update(s,{status:"pending_company",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"notifications"));t.set(d,{userId:n.companyId,type:"application_approved_admin",title:"新しい応募が届きました",message:"管理者承認済みの応募があります。内容を確認してください。",link:"/company/applicants",read:!1,createdAt:(0,r.Bt)()})})}}let n=new i},45877:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx#default`)},52052:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx#default`)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[379,499,331,906,106,812,553,93],()=>s(70837));module.exports=a})();