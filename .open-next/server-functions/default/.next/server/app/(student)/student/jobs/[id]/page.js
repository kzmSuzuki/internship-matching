(()=>{var e={};e.id=422,e.ids=[422],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},70837:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>o,routeModule:()=>h,tree:()=>c}),s(45877),s(52052),s(90996),s(15539);var a=s(30170),r=s(45002),i=s(83876),n=s.n(i),l=s(66299),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let c=["",{children:["(student)",{children:["student",{children:["jobs",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,45877)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,52052)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,15539)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx"],u="/(student)/student/jobs/[id]/page",p={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(student)/student/jobs/[id]/page",pathname:"/student/jobs/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},92862:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,63642,23)),Promise.resolve().then(s.t.bind(s,87586,23)),Promise.resolve().then(s.t.bind(s,47838,23)),Promise.resolve().then(s.t.bind(s,58057,23)),Promise.resolve().then(s.t.bind(s,77741,23)),Promise.resolve().then(s.t.bind(s,13118,23))},21073:(e,t,s)=>{Promise.resolve().then(s.bind(s,222))},9970:(e,t,s)=>{Promise.resolve().then(s.bind(s,87506))},17020:(e,t,s)=>{Promise.resolve().then(s.bind(s,64405))},50820:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},62752:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},32348:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},9527:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},49256:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},5271:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},87506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(97247),r=s(28964);s(62216);var i=s(94082),n=s(222),l=s(55039),d=s(17596),c=s(76219),o=s(8749),u=s(77256),p=s(9527),h=s(50820),m=s(32348),x=s(20290),f=s(96369),y=s(34178),g=s(68170);function b({params:e}){let{id:t}=e,{user:s}=(0,n.a)(),[b,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),[N,k]=(0,r.useState)(!0),[I,E]=(0,r.useState)(!1),[A,P]=(0,r.useState)(!1),[U,Z]=(0,r.useState)(null),[_,B]=(0,r.useState)(null),[z,J]=(0,r.useState)(""),q=(0,y.useRouter)(),C=async()=>{if(s&&b){if(U){let e=U.status;if(U.jobId===b.id&&e.includes("rejected")){alert("この求人は不採用となったため、再応募できません。");return}if(["pending_admin","pending_company","pending_student","matched"].includes(e)){alert("既に応募中の求人があるか、この求人に応募済みです。");return}}if(confirm("この求人に応募しますか？\n※同時に応募できるのは1件のみです。")){E(!0);try{await g.v.applyJob(s.id,b.id,b.companyId,z),q.push("/student/applications")}catch(e){console.error("Error applying:",e),alert("応募に失敗しました: "+e.message)}finally{E(!1)}}}},F=async()=>{if(b?.pdfFileId&&i.I.currentUser)try{let e=await i.I.currentUser.getIdToken(),t=await fetch(`/api/pdf/${b.pdfFileId}`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("PDF取得失敗");let s=await t.blob(),a=URL.createObjectURL(s);window.open(a,"_blank"),setTimeout(()=>URL.revokeObjectURL(a),6e4)}catch(e){console.error(e),alert("PDFを表示できませんでした")}};if(N)return a.jsx("div",{className:"flex justify-center p-12",children:a.jsx(o.Z,{className:"animate-spin"})});if(!b)return a.jsx("div",{className:"text-center p-12",children:"求人が見つかりません"});let M=U?.jobId===b.id,D=M&&U?.status.includes("rejected"),S=!!U&&!D;return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsx(d.Z,{className:"p-8",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#1E3A5F] mb-2",children:b.title}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-gray-600 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(u.Z,{size:16}),a.jsx("span",{children:b.companyName||j?.name||"企業名不明"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(p.Z,{size:16}),a.jsx("span",{children:b.location})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(h.Z,{size:16}),a.jsx("span",{children:b.createdAt?.toDate?(0,f.WU)(b.createdAt.toDate(),"yyyy/MM/dd"):"-"})]})]}),a.jsx("div",{className:"flex gap-2",children:b.requirements.map((e,t)=>a.jsx(c.C,{variant:"outline",className:"bg-gray-50",children:e},t))})]}),a.jsx("div",{className:"md:text-right",children:M?(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2 text-warning-600",children:[D?a.jsx(c.C,{variant:"error",className:"text-lg px-4 py-2 bg-red-100 text-red-600 border-red-200",children:"不採用"}):a.jsx(c.C,{variant:"success",className:"text-lg px-4 py-2",children:"応募済み"}),a.jsx("span",{className:"text-xs text-gray-500",children:D?"※再応募はできません":"※ステータスは応募履歴で確認できます"})]}):S?(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2 text-warning-600",children:[a.jsx(c.C,{variant:"warning",className:"text-lg px-4 py-2 opacity-50 cursor-not-allowed",children:"他の求人に応募中"}),a.jsx("span",{className:"text-xs text-gray-500",children:"※同時に応募できるのは1件のみです"})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-3 w-full max-w-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 text-left",children:"企業へのメッセージ (任意)"}),a.jsx("textarea",{className:"w-full h-20 rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#1E3A5F] resize-none",placeholder:"自己PRや志望動機などを入力...",value:z,onChange:e=>J(e.target.value)})]}),a.jsx(l.z,{size:"lg",onClick:C,isLoading:I,className:"w-full",children:"この求人に応募する"})]})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"md:col-span-2 space-y-6",children:(0,a.jsxs)(d.Z,{className:"p-6",children:[a.jsx("h2",{className:"text-lg font-bold mb-4 border-b pb-2",children:"募集要項 (PDF)"}),b.pdfFileId?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[a.jsx("div",{className:"mb-4 text-[#1E3A5F]",children:a.jsx(m.Z,{size:48})}),a.jsx("p",{className:"text-gray-600 mb-4 font-medium",children:"PDFファイルが添付されています"}),(0,a.jsxs)(l.z,{variant:"outline",className:"w-full max-w-xs flex items-center justify-center gap-2 bg-white hover:bg-gray-50",onClick:async()=>{P(!0),await F(),P(!1)},isLoading:A,children:[!A&&a.jsx(m.Z,{size:16}),"PDFを確認する"]})]}):(0,a.jsxs)("div",{className:"aspect-[1/4] w-full bg-gray-50 rounded-lg flex flex-col items-center justify-center text-gray-400 p-8",children:[a.jsx(x.Z,{size:32,className:"mb-2"}),a.jsx("p",{children:"PDFファイルがありません"})]})]})}),a.jsx("div",{className:"space-y-6",children:(0,a.jsxs)(d.Z,{className:"p-6",children:[a.jsx("h2",{className:"text-lg font-bold mb-4",children:"企業情報"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"業界"}),a.jsx("p",{children:j?.industry||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"住所"}),a.jsx("p",{children:j?.address||"-"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-gray-500 text-xs block",children:"Webサイト"}),a.jsx("a",{href:j?.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate block",children:j?.website||"-"})]})]})]})})]})]})}},64405:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(97247),r=s(91360);function i({children:e}){return a.jsx(r.Z,{children:e})}},91360:(e,t,s)=>{"use strict";s.d(t,{Z:()=>j});var a=s(97247),r=s(79906),i=s(34178),n=s(40677),l=s(222);let d=(0,s(9148).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);var c=s(49256),o=s(66903),u=s(5271),p=s(21697),h=s(42310),m=s(57989),x=s(62752),f=s(77256),y=s(31500),g=s(19400);function b(){let e=(0,i.usePathname)(),{user:t,logout:s}=(0,l.a)(),b=(()=>{if(!t)return[];switch(t.role){case"student":return[{icon:d,label:"ホーム",href:"/"},{icon:c.Z,label:"求人検索",href:"/student/jobs"},{icon:o.Z,label:"応募履歴",href:"/student/applications"},{icon:u.Z,label:"プロフィール",href:"/student/profile"}];case"company":return[{icon:p.Z,label:"ダッシュボード",href:"/company/dashboard"},{icon:h.Z,label:"自社求人管理",href:"/company/jobs"},{icon:m.Z,label:"応募者管理",href:"/company/applicants"},{icon:u.Z,label:"企業情報",href:"/company/profile"}];case"admin":return[{icon:p.Z,label:"ダッシュボード",href:"/admin/dashboard"},{icon:x.Z,label:"求人承認",href:"/admin/jobs"},{icon:o.Z,label:"応募管理",href:"/admin/applications"},{icon:m.Z,label:"ユーザー管理",href:"/admin/users"},{icon:f.Z,label:"企業管理",href:"/admin/companies"},{icon:y.Z,label:"インターン実施状況",href:"/admin/matches"}];default:return[{icon:d,label:"ホーム",href:"/"}]}})();return(0,a.jsxs)("aside",{className:"fixed left-4 top-4 z-40 h-[calc(100vh-2rem)] w-18 glass rounded-2xl border-r-0 flex flex-col items-center py-6 transition-all duration-300",children:[a.jsx("div",{className:"mb-8 p-2 rounded-xl bg-[#161B33]/10",children:a.jsx("div",{className:"w-8 h-8 rounded-full bg-[#161B33]"})}),a.jsx("nav",{className:"flex-1 flex flex-col gap-4 w-full items-center px-2",children:b.map(t=>{let s=e===t.href||e.startsWith(t.href+"/");return(0,a.jsxs)(r.default,{href:t.href,className:(0,n.cn)("relative group flex items-center justify-center w-12 h-12 rounded-xl transition-all duration-200",s?"bg-[#161B33] text-white shadow-md shadow-[#161B33]/20":"text-gray-500 hover:bg-[#161B33]/10 hover:text-[#161B33]"),children:[a.jsx(t.icon,{size:22,strokeWidth:s?2.5:2}),a.jsx("span",{className:"absolute left-14 px-2 py-1 bg-[#1E3A5F] text-white text-xs rounded opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all whitespace-nowrap z-50",children:t.label})]},t.href)})}),a.jsx("button",{onClick:s,className:"mt-auto p-3 text-gray-500 hover:text-[#F56565] hover:bg-[#F56565]/10 rounded-xl transition-all",children:a.jsx(g.Z,{size:22})})]})}function v(){let{user:e}=(0,l.a)();return(0,a.jsxs)("header",{className:"sticky top-0 z-30 w-full flex justify-end px-6 mt-4 pointer-events-none",children:[a.jsx("div",{className:"hidden"}),a.jsx("div",{className:"flex items-center gap-4 glass px-6 py-2 rounded-2xl shadow-sm pointer-events-auto",children:(0,a.jsxs)(r.default,{href:e?.role==="student"?"/student/profile":e?.role==="company"?"/company/profile":"/",className:"flex items-center gap-3 pl-2 hover:opacity-80 transition-opacity",children:[(0,a.jsxs)("div",{className:"text-right hidden sm:block",children:[a.jsx("p",{className:"text-sm font-medium text-[#161B33]",children:e?.name||"ゲスト"}),a.jsx("p",{className:"text-xs text-gray-500",children:e?.role==="student"?"学生アカウント":e?.role==="company"?"企業アカウント":e?.role==="admin"?"管理者":"ゲスト"})]}),a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[#161B33] to-[#2D5A8E] shadow-md border-2 border-white cursor-pointer"})]})})]})}function j({children:e}){return(0,a.jsxs)("div",{className:"min-h-screen text-[#161B33] font-sans",children:[a.jsx(b,{}),(0,a.jsxs)("div",{className:"pl-24 flex flex-col min-h-screen transition-all duration-300",children:[a.jsx(v,{}),a.jsx("main",{className:"flex-1 p-6 md:p-8 overflow-x-hidden",children:a.jsx("div",{className:"max-w-7xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:e})})]})]})}},76219:(e,t,s)=>{"use strict";s.d(t,{C:()=>n});var a=s(97247),r=s(28964),i=s(40677);let n=(0,r.forwardRef)(({className:e,variant:t="default",...s},r)=>a.jsx("span",{ref:r,className:(0,i.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[t],e),...s}));n.displayName="Badge"},55039:(e,t,s)=>{"use strict";s.d(t,{z:()=>l});var a=s(97247),r=s(28964),i=s(40677),n=s(8749);let l=(0,r.forwardRef)(({className:e,variant:t="primary",size:s="md",isLoading:r,children:l,disabled:d,...c},o)=>(0,a.jsxs)("button",{ref:o,className:(0,i.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[s],e),disabled:d||r,...c,children:[r&&a.jsx(n.Z,{className:"mr-2 h-4 w-4 animate-spin"}),l]}));l.displayName="Button"},17596:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(97247),r=s(28964),i=s(40677);let n=(0,r.forwardRef)(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,i.cn)("glass rounded-2xl p-6 transition-all duration-300",e),...t}));n.displayName="Card"},222:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>o,a:()=>u});var a=s(97247),r=s(28964),i=s(85503),n=s(62216),l=s(94082),d=s(34178);let c=(0,r.createContext)({user:null,firebaseUser:null,loading:!0,emailVerified:!1,logout:async()=>{},refreshUser:async()=>{}});function o({children:e}){let[t,s]=(0,r.useState)(null),[o,u]=(0,r.useState)(null),[p,h]=(0,r.useState)(!0),[m,x]=(0,r.useState)(!1),f=(0,d.useRouter)(),y=async e=>{try{let t=await (0,n.QT)((0,n.JU)(l.db,"users",e.uid));t.exists()?s({id:t.id,...t.data()}):s(null)}catch(e){console.error("Error fetching user data:",e),s(null)}},g=async()=>{await (0,i.w7)(l.I),s(null),u(null),x(!1),f.push("/login")},b=async()=>{let e=l.I.currentUser;e&&(await e.reload(),x(e.emailVerified),await y(e))};return a.jsx(c.Provider,{value:{user:t,firebaseUser:o,loading:p,emailVerified:m,logout:g,refreshUser:b},children:e})}let u=()=>(0,r.useContext)(c)},94082:(e,t,s)=>{"use strict";s.d(t,{I:()=>l,V:()=>c,db:()=>d});var a=s(68132),r=s(85503),i=s(62216);let n=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyDL2GylAt2YVRSstEpp4hucbcqw7RuVk4o",authDomain:"internship-matching-app.firebaseapp.com",projectId:"internship-matching-app",messagingSenderId:"299078518812",appId:"1:299078518812:web:03ad34bb4323c497a677d9"}):(0,a.C6)()[0],l=(0,r.v0)(n),d=(0,i.ad)(n),c=new r.hJ},67413:(e,t,s)=>{"use strict";async function a(e,t,s){try{let a=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:t,body:s})});if(!a.ok)return console.error("Failed to send email:",await a.text()),!1;return!0}catch(e){return console.error("Error sending email:",e),!1}}s.d(t,{C:()=>a})},40677:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var a=s(61929),r=s(35770);function i(...e){return(0,r.m6)((0,a.W)(e))}},68170:(e,t,s)=>{"use strict";s.d(t,{v:()=>l});var a=s(94082),r=s(62216),i=s(67413);class n{async getUserEmail(e){try{let t=await (0,r.QT)((0,r.JU)(a.db,"users",e));if(t.exists())return t.data().email}catch(e){console.error("Error fetching user email:",e)}return null}async applyJob(e,t,s,n=""){try{let l=await (0,r.i3)(a.db,async i=>{let l=(0,r.hJ)(a.db,"applications"),d=(0,r.IO)(l,(0,r.ar)("studentId","==",e),(0,r.ar)("status","in",["pending_admin","pending_company","pending_student","matched"]));if(!(await (0,r.PL)(d)).empty)throw Error("Already have an active application");let c=(0,r.JU)((0,r.hJ)(a.db,"applications")),o={jobId:t,studentId:e,companyId:s,status:"pending_admin",message:n,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()},u=(0,r.JU)((0,r.hJ)(a.db,"notifications")),p={userId:"admin",type:"job_applied",title:"新規応募がありました",message:`求人ID: ${t} に新しい応募があります。`,link:`/admin/applications/${c.id}`,read:!1,createdAt:(0,r.Bt)()};return i.set(c,o),i.set(u,p),c.id}),d=await this.getUserEmail(e);return d&&await (0,i.C)(d,"【Internship Match】応募完了のお知らせ",`求人への応募が完了しました。

管理者の確認をお待ちください。
求人ID: ${t}`),l}catch(e){throw console.error("MatchingService.applyJob error:",e),e}}async acceptMatchByStudent(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let l=n.data();if(l.studentId!==t)throw Error("Unauthorized");if("pending_student"!==l.status)throw Error("Invalid status");s.update(i,{status:"matched",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"matches")),c={applicationId:e,jobId:l.jobId,studentId:l.studentId,companyId:l.companyId,status:"active",startDate:(0,r.Bt)(),createdAt:(0,r.Bt)()};s.set(d,c),s.update(i,{matchId:d.id});let o=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(o,{userId:l.companyId,type:"offer_accepted",title:"マッチング成立！",message:"学生がオファーを承諾しました。インターンシップの準備を始めましょう。",link:`/company/intern/${d.id}`,read:!1,createdAt:(0,r.Bt)()})});try{let t=await (0,r.QT)((0,r.JU)(a.db,"applications",e));if(t.exists()){let e=t.data(),s=await this.getUserEmail(e.companyId);s&&await (0,i.C)(s,"【Internship Match】マッチング成立のお知らせ",`学生がオファーを承諾しました！

マイページから詳細を確認してください。`)}}catch(e){console.error("Email send failed:",e)}}async approveByCompany(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let l=n.data();if(l.companyId!==t)throw Error("Unauthorized");if("pending_company"!==l.status)throw Error("Invalid status (Must be pending_company)");s.update(i,{status:"pending_student",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(d,{userId:l.studentId,type:"offer_received",title:"マッチングオファーが届きました！",message:"企業があなたの応募に関心を持っています。オファーを確認してください。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})});try{let t=await (0,r.QT)((0,r.JU)(a.db,"applications",e));if(t.exists()){let e=t.data(),s=await this.getUserEmail(e.studentId);s&&await (0,i.C)(s,"【Internship Match】オファー受信のお知らせ",`企業からオファーが届きました！

マイページから確認・承諾を行ってください。`)}}catch(e){console.error("Email send failed:",e)}}async rejectByCompany(e,t){await (0,r.i3)(a.db,async s=>{let i=(0,r.JU)(a.db,"applications",e),n=await s.get(i);if(!n.exists())throw Error("Application not found");let l=n.data();if(l.companyId!==t)throw Error("Unauthorized");s.update(i,{status:"rejected_by_company",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(d,{userId:l.studentId,type:"offer_rejected",title:"選考結果のお知らせ",message:"残念ながら今回の応募は見送られました。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})});try{let t=await (0,r.QT)((0,r.JU)(a.db,"applications",e));if(t.exists()){let e=t.data(),s=await this.getUserEmail(e.studentId);s&&await (0,i.C)(s,"【Internship Match】選考結果のお知らせ",`残念ながら、今回の応募は見送られました。
またの応募をお待ちしております。`)}}catch(e){console.error("Email send failed:",e)}}async approveByAdmin(e){await (0,r.i3)(a.db,async t=>{let s=(0,r.JU)(a.db,"applications",e),i=await t.get(s);if(!i.exists())throw Error("Application not found");let n=i.data();if("pending_admin"!==n.status)throw Error("Invalid status");t.update(s,{status:"pending_company",updatedAt:(0,r.Bt)()});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));t.set(l,{userId:n.companyId,type:"application_approved_admin",title:"新しい応募が届きました",message:"管理者承認済みの応募があります。内容を確認してください。",link:"/company/applicants",read:!1,createdAt:(0,r.Bt)()})});try{let t=await (0,r.QT)((0,r.JU)(a.db,"applications",e));if(t.exists()){let e=t.data(),s=await this.getUserEmail(e.companyId);s&&await (0,i.C)(s,"【Internship Match】新規応募のお知らせ",`新しい応募が届きました（管理者承認済み）。

マイページから応募者を確認してください。`)}}catch(e){console.error("Email send failed:",e)}}}let l=new n},45877:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/jobs/[id]/page.tsx#default`)},52052:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx#default`)},15539:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,metadata:()=>d});var a=s(72051),r=s(23635),i=s.n(r);s(5023);var n=s(45347);let l=(0,n.createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/contexts/AuthContext.tsx#AuthProvider`);(0,n.createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/contexts/AuthContext.tsx#useAuth`);let d={title:"Internship Matching",description:"Internship Matching Platform"};function c({children:e}){return a.jsx("html",{lang:"ja",children:a.jsx("body",{className:i().className,children:a.jsx(l,{children:e})})})}},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(54564);let r=e=>[{type:"image/x-icon",sizes:"48x48",url:(0,a.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[379,24,564,790,906,557],()=>s(70837));module.exports=a})();