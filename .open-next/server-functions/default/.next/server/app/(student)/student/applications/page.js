(()=>{var e={};e.id=9,e.ids=[9],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},57255:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>l,routeModule:()=>m,tree:()=>o}),s(58161),s(52052),s(90996),s(15539);var a=s(30170),r=s(45002),n=s(83876),i=s.n(n),d=s(66299),c={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);s.d(t,c);let o=["",{children:["(student)",{children:["student",{children:["applications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,58161)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/applications/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,52052)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,15539)),"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/applications/page.tsx"],p="/(student)/student/applications/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(student)/student/applications/page",pathname:"/student/applications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},68257:(e,t,s)=>{Promise.resolve().then(s.bind(s,80808))},17020:(e,t,s)=>{Promise.resolve().then(s.bind(s,64405))},77256:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]])},9527:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(9148).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},80808:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(97247),r=s(28964);s(62216),s(94082);var n=s(222),i=s(17596),d=s(76219),c=s(55039),o=s(8749),l=s(77256),p=s(9527),u=s(8553),m=s(79906),h=s(34178),x=s(68170);function y(){let{user:e}=(0,n.a)(),[t,s]=(0,r.useState)([]),[y,g]=(0,r.useState)(!0),f=(0,h.useRouter)(),b=e=>{switch(e){case"pending_admin":return a.jsx(d.C,{variant:"warning",children:"管理者承認待ち"});case"pending_company":return a.jsx(d.C,{variant:"warning",children:"企業選考中"});case"pending_student":return a.jsx(d.C,{variant:"success",children:"マッチングオファー届いています！"});case"matched":return a.jsx(d.C,{variant:"success",className:"bg-green-500 text-white",children:"マッチング成立"});case"rejected_by_admin":case"rejected_by_company":return a.jsx(d.C,{variant:"error",children:"不採用"});case"cancelled":return a.jsx(d.C,{variant:"outline",children:"辞退/キャンセル"});default:return a.jsx(d.C,{variant:"outline",children:e})}},v=async t=>{if(e&&confirm("マッチングを承認しますか？\nこれでインターンシップが確定します。"))try{await x.v.acceptMatchByStudent(t,e.id),alert("マッチングが成立しました！"),g(!0),window.location.reload()}catch(e){console.error("Error accepting match:",e),alert("承認に失敗しました: "+e.message)}};return y?a.jsx("div",{className:"flex justify-center p-12",children:a.jsx(o.Z,{className:"animate-spin"})}):(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#1E3A5F]",children:"応募履歴"}),a.jsx("p",{className:"text-gray-500",children:"あなたの応募状況を確認できます"})]}),0===t.length?(0,a.jsxs)(i.Z,{className:"p-12 text-center text-gray-500",children:[a.jsx("p",{children:"まだ応募した求人はありません。"}),a.jsx(c.z,{className:"mt-4",onClick:()=>f.push("/student/jobs"),children:"求人を探す"})]}):a.jsx("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)(i.Z,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:["応募日: ",e.createdAt?(0,u.WU)(e.createdAt.toDate(),"yyyy/MM/dd HH:mm"):"-"]}),b(e.status)]}),a.jsx("h3",{className:"text-xl font-bold text-[#1E3A5F]",children:e.job.title||"求人削除済み"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(l.Z,{size:14}),a.jsx("span",{children:e.company.name||"企業名不明"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(p.Z,{size:14}),a.jsx("span",{children:e.job.location})]})]})]}),a.jsx("div",{className:"flex items-center",children:a.jsx(m.default,{href:`/student/jobs/${e.jobId}`,children:a.jsx(c.z,{variant:"outline",size:"sm",children:"求人詳細を見る"})})})]}),"pending_student"===e.status&&(0,a.jsxs)("div",{className:"mt-4 bg-[#48BB78]/10 p-4 rounded-lg flex justify-between items-center",children:[a.jsx("p",{className:"text-[#2F855A] font-medium text-sm",children:"企業からマッチングのオファーが届いています！承認してインターンを開始しましょう。"}),a.jsx(c.z,{variant:"primary",className:"bg-[#48BB78] hover:bg-[#48BB78]/90",onClick:()=>v(e.id),children:"マッチングを承認する"})]}),("matched"===e.status||"completed"===e.status)&&e.matchId&&(0,a.jsxs)("div",{className:"mt-4 bg-[#1E3A5F]/5 p-4 rounded-lg flex justify-between items-center",children:[a.jsx("p",{className:"text-[#1E3A5F] font-medium text-sm",children:"インターンシップが進行中(または完了)です。日報や評価を確認しましょう。"}),a.jsx(m.default,{href:`/student/intern/${e.matchId}`,children:a.jsx(c.z,{className:"bg-[#1E3A5F]",children:"インターンシップ画面へ"})})]})]},e.id))})]})}},64405:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(97247),r=s(59574);function n({children:e}){return a.jsx(r.Z,{children:e})}},76219:(e,t,s)=>{"use strict";s.d(t,{C:()=>i});var a=s(97247),r=s(28964),n=s(40677);let i=(0,r.forwardRef)(({className:e,variant:t="default",...s},r)=>a.jsx("span",{ref:r,className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[t],e),...s}));i.displayName="Badge"},55039:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});var a=s(97247),r=s(28964),n=s(40677),i=s(8749);let d=(0,r.forwardRef)(({className:e,variant:t="primary",size:s="md",isLoading:r,children:d,disabled:c,...o},l)=>(0,a.jsxs)("button",{ref:l,className:(0,n.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[s],e),disabled:c||r,...o,children:[r&&a.jsx(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}),d]}));d.displayName="Button"},68170:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});var a=s(94082),r=s(62216);class n{async applyJob(e,t,s,n=""){try{return await (0,r.i3)(a.db,async i=>{let d=(0,r.hJ)(a.db,"applications"),c=(0,r.IO)(d,(0,r.ar)("studentId","==",e),(0,r.ar)("status","in",["pending_admin","pending_company","pending_student","matched"]));if(!(await (0,r.PL)(c)).empty)throw Error("Already have an active application");let o=(0,r.JU)((0,r.hJ)(a.db,"applications")),l={jobId:t,studentId:e,companyId:s,status:"pending_admin",message:n,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()},p=(0,r.JU)((0,r.hJ)(a.db,"notifications")),u={userId:"admin",type:"job_applied",title:"新規応募がありました",message:`求人ID: ${t} に新しい応募があります。`,link:`/admin/applications/${o.id}`,read:!1,createdAt:(0,r.Bt)()};return i.set(o,l),i.set(p,u),o.id})}catch(e){throw console.error("MatchingService.applyJob error:",e),e}}async acceptMatchByStudent(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.studentId!==t)throw Error("Unauthorized");if("pending_student"!==d.status)throw Error("Invalid status");s.update(n,{status:"matched",updatedAt:(0,r.Bt)()});let c=(0,r.JU)((0,r.hJ)(a.db,"matches")),o={applicationId:e,jobId:d.jobId,studentId:d.studentId,companyId:d.companyId,status:"active",startDate:(0,r.Bt)(),createdAt:(0,r.Bt)()};s.set(c,o),s.update(n,{matchId:c.id});let l=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(l,{userId:d.companyId,type:"offer_accepted",title:"マッチング成立！",message:"学生がオファーを承諾しました。インターンシップの準備を始めましょう。",link:`/company/intern/${c.id}`,read:!1,createdAt:(0,r.Bt)()})})}async approveByCompany(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.companyId!==t)throw Error("Unauthorized");if("pending_company"!==d.status)throw Error("Invalid status (Must be pending_company)");s.update(n,{status:"pending_student",updatedAt:(0,r.Bt)()});let c=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(c,{userId:d.studentId,type:"offer_received",title:"マッチングオファーが届きました！",message:"企業があなたの応募に関心を持っています。オファーを確認してください。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async rejectByCompany(e,t){await (0,r.i3)(a.db,async s=>{let n=(0,r.JU)(a.db,"applications",e),i=await s.get(n);if(!i.exists())throw Error("Application not found");let d=i.data();if(d.companyId!==t)throw Error("Unauthorized");s.update(n,{status:"rejected_by_company",updatedAt:(0,r.Bt)()});let c=(0,r.JU)((0,r.hJ)(a.db,"notifications"));s.set(c,{userId:d.studentId,type:"offer_rejected",title:"選考結果のお知らせ",message:"残念ながら今回の応募は見送られました。",link:"/student/applications",read:!1,createdAt:(0,r.Bt)()})})}async approveByAdmin(e){await (0,r.i3)(a.db,async t=>{let s=(0,r.JU)(a.db,"applications",e),n=await t.get(s);if(!n.exists())throw Error("Application not found");let i=n.data();if("pending_admin"!==i.status)throw Error("Invalid status");t.update(s,{status:"pending_company",updatedAt:(0,r.Bt)()});let d=(0,r.JU)((0,r.hJ)(a.db,"notifications"));t.set(d,{userId:i.companyId,type:"application_approved_admin",title:"新しい応募が届きました",message:"管理者承認済みの応募があります。内容を確認してください。",link:"/company/applicants",read:!1,createdAt:(0,r.Bt)()})})}}let i=new n},58161:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/applications/page.tsx#default`)},52052:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(45347).createProxy)(String.raw`/Users/kazuma/Documents/dev/intern/internship-matching/src/app/(student)/student/layout.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[379,499,331,906,106,812,553,93],()=>s(57255));module.exports=a})();