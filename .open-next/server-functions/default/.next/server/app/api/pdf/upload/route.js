"use strict";(()=>{var e={};e.id=588,e.ids=[588],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},77822:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>S,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>A,staticGenerationAsyncStorage:()=>f});var o={};t.r(o),t.d(o,{POST:()=>d});var s=t(73278),a=t(45002),n=t(54877),i=t(71309);let p=process.env.GAS_API_URL||"",u=process.env.GAS_API_KEY||"";async function d(e){try{let r;if(!p||"YOUR_GAS_WEB_APP_URL"===p)return console.error("GAS_API_URL is not configured"),i.NextResponse.json({error:"Server configuration error: GAS API URL not set"},{status:500});if(!u||"YOUR_SECRET_API_KEY"===u)return console.error("GAS_API_KEY is not configured"),i.NextResponse.json({error:"Server configuration error: GAS API Key not set"},{status:500});let t=(await e.formData()).get("file");if(!t)return i.NextResponse.json({error:"No file provided"},{status:400});if(t.size>10485760)return i.NextResponse.json({error:"File too large (max 10MB)"},{status:400});let o=await t.arrayBuffer(),s=new Uint8Array(o),a="";for(let e=0;e<s.byteLength;e++)a+=String.fromCharCode(s[e]);let n=btoa(a),d={apiKey:u,fileName:t.name,mimeType:t.type,fileData:n},l=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),redirect:"manual"});if(302===l.status){let e=l.headers.get("location");e&&(l=await fetch(e))}else if(401===l.status||403===l.status)return console.error("[PDF Upload] GAS Auth Error."),i.NextResponse.json({error:"GASへのアクセス権限がありません。デプロイ設定を確認してください。"},{status:500});let c=await l.text();if(c.trim().toLowerCase().startsWith("<!doctype")||c.trim().toLowerCase().startsWith("<html"))return console.error("[PDF Upload] GAS returned HTML instead of JSON."),i.NextResponse.json({error:"GAS APIがHTMLを返しました。設定を確認してください。"},{status:500});try{r=JSON.parse(c)}catch(e){return console.error("[PDF Upload] Failed to parse GAS response as JSON"),i.NextResponse.json({error:"GAS APIのレスポンスをパースできませんでした"},{status:500})}if(r.error)return console.error("[PDF Upload] GAS returned error:",r.error),i.NextResponse.json({error:r.error},{status:500});if(!r.fileId)return console.error("[PDF Upload] GAS response missing fileId"),i.NextResponse.json({error:"GAS APIからfileIdが返されませんでした"},{status:500});return i.NextResponse.json(r)}catch(e){return console.error("[PDF Upload] Error:",e.message),i.NextResponse.json({error:`PDFアップロードエラー: ${e.message}`},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/pdf/upload/route",pathname:"/api/pdf/upload",filename:"route",bundlePath:"app/api/pdf/upload/route"},resolvedPagePath:"/Users/kazuma/Documents/dev/intern/internship-matching/src/app/api/pdf/upload/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:c,staticGenerationAsyncStorage:f,serverHooks:A}=l,m="/api/pdf/upload/route";function S(){return(0,n.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:f})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[379,833],()=>t(77822));module.exports=o})();