"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{7041:function(e,t,s){s.d(t,{Z:function(){return Z}});var a=s(7437),r=s(7648),l=s(9376),n=s(3448),i=s(4938),d=s(3247),o=s(5005),c=s(8736),u=s(2369),x=s(8728),m=s(7692);let h=[{icon:i.Z,label:"ホーム",href:"/"},{icon:d.Z,label:"求人検索",href:"/student/jobs"},{icon:o.Z,label:"企業求人",href:"/company/jobs"},{icon:c.Z,label:"応募管理",href:"/student/applications"},{icon:u.Z,label:"プロフィール",href:"/student/profile"},{icon:x.Z,label:"設定",href:"/settings"}];function f(){let e=(0,l.usePathname)();return(0,a.jsxs)("aside",{className:"fixed left-4 top-4 z-40 h-[calc(100vh-2rem)] w-18 glass rounded-2xl border-r-0 flex flex-col items-center py-6 transition-all duration-300",children:[(0,a.jsx)("div",{className:"mb-8 p-2 rounded-xl bg-[#161B33]/10",children:(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#161B33]"})}),(0,a.jsx)("nav",{className:"flex-1 flex flex-col gap-4 w-full px-2",children:h.map(t=>{let s=e===t.href;return(0,a.jsxs)(r.default,{href:t.href,className:(0,n.cn)("relative group flex items-center justify-center w-12 h-12 rounded-xl transition-all duration-200",s?"bg-[#161B33] text-white shadow-md shadow-[#161B33]/20":"text-gray-500 hover:bg-[#161B33]/10 hover:text-[#161B33]"),children:[(0,a.jsx)(t.icon,{size:22,strokeWidth:s?2.5:2}),(0,a.jsx)("span",{className:"absolute left-14 px-2 py-1 bg-[#1E3A5F] text-white text-xs rounded opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all whitespace-nowrap z-50",children:t.label})]},t.href)})}),(0,a.jsx)("button",{className:"mt-auto p-3 text-gray-500 hover:text-[#F56565] hover:bg-[#F56565]/10 rounded-xl transition-all",children:(0,a.jsx)(m.Z,{size:22})})]})}var p=s(4362),b=s(6410),g=s(6943),v=s(2265);class j{async markAsRead(e){let t=(0,g.JU)(b.db,"notifications",e);await (0,g.r7)(t,{read:!0,updatedAt:(0,g.Bt)()})}async markAllAsRead(e){let t=(0,g.IO)((0,g.hJ)(b.db,"notifications"),(0,g.ar)("userId","==",e),(0,g.ar)("read","==",!1)),s=await (0,g.PL)(t);if(s.empty)return;let a=(0,g.qs)(b.db);s.docs.forEach(e=>{a.update(e.ref,{read:!0,updatedAt:(0,g.Bt)()})}),await a.commit()}}let y=new j;var w=s(4766),N=s(401),k=s(9795),A=s(9073);function B(){let{user:e}=(0,p.a)(),{notifications:t,unreadCount:s}=function(e){let[t,s]=(0,v.useState)([]),[a,r]=(0,v.useState)(0),[l,n]=(0,v.useState)(!0);return(0,v.useEffect)(()=>{if(!e){s([]),r(0),n(!1);return}let t=(0,g.IO)((0,g.hJ)(b.db,"notifications"),(0,g.ar)("userId","==",e),(0,g.Xo)("createdAt","desc"),(0,g.b9)(20)),a=(0,g.cf)(t,e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));s(t),r(t.filter(e=>!e.read).length),n(!1)});return()=>a()},[e]),{notifications:t,unreadCount:a,loading:l}}(null==e?void 0:e.id),[r,n]=(0,v.useState)(!1),i=(0,l.useRouter)(),d=(0,v.useRef)(null);(0,v.useEffect)(()=>{function e(e){d.current&&!d.current.contains(e.target)&&n(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d]);let o=async e=>{e.read||await y.markAsRead(e.id),n(!1),e.link&&i.push(e.link)},c=async()=>{e&&await y.markAllAsRead(e.id)};return e?(0,a.jsxs)("div",{className:"relative",ref:d,children:[(0,a.jsxs)("button",{className:"relative p-2 text-gray-500 hover:text-gray-700 transition-colors",onClick:()=>n(!r),children:[(0,a.jsx)(w.Z,{size:24}),s>0&&(0,a.jsx)("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-bold leading-none text-red-100 bg-red-600 rounded-full transform translate-x-1/4 -translate-y-1/4",children:s>9?"9+":s})]}),r&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-100 z-50 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center px-4 py-2 border-b bg-gray-50",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-gray-700",children:"通知"}),s>0&&(0,a.jsxs)("button",{onClick:c,className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[(0,a.jsx)(N.Z,{size:12}),"すべて既読にする"]})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===t.length?(0,a.jsx)("div",{className:"p-8 text-center text-gray-400 text-sm",children:"通知はありません"}):(0,a.jsx)("ul",{className:"divide-y divide-gray-100",children:t.map(e=>(0,a.jsx)("li",{className:"p-3 hover:bg-gray-50 cursor-pointer transition-colors ".concat(e.read?"":"bg-blue-50/50"),onClick:()=>o(e),children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"mt-1",children:e.read?(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}):(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 mb-1",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 line-clamp-2 mb-1",children:e.message}),(0,a.jsx)("p",{className:"text-[10px] text-gray-400",children:e.createdAt?(0,k.Q)(e.createdAt.toDate(),{addSuffix:!0,locale:A.ja}):"-"})]})]})},e.id))})}),(0,a.jsx)("div",{className:"p-2 border-t bg-gray-50 text-center",children:(0,a.jsx)("button",{onClick:()=>i.push("/settings/notifications"),className:"text-xs text-gray-500 hover:text-gray-700",children:"通知設定"})})]})]}):null}function E(){let{user:e}=(0,p.a)();return(0,a.jsxs)("header",{className:"sticky top-0 z-30 w-full h-16 px-6 flex items-center justify-between glass border-b-0 rounded-2xl mx-auto max-w-[98%] mt-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 flex-1",children:(0,a.jsxs)("div",{className:"relative w-64 md:w-96 hidden md:block",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,a.jsx)("input",{type:"text",placeholder:"検索...",className:"w-full h-10 pl-10 pr-4 rounded-full bg-white/50 border-none focus:ring-2 focus:ring-[#161B33]/20 text-sm shadow-sm backdrop-blur-sm transition-all"})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(B,{}),(0,a.jsxs)("div",{className:"flex items-center gap-3 pl-4 border-l border-gray-200",children:[(0,a.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-[#161B33]",children:(null==e?void 0:e.name)||"ゲスト"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(null==e?void 0:e.role)==="student"?"学生アカウント":(null==e?void 0:e.role)==="company"?"企業アカウント":(null==e?void 0:e.role)==="admin"?"管理者":"ゲスト"})]}),(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-[#161B33] to-[#2D5A8E] shadow-md border-2 border-white cursor-pointer"})]})]})]})}function Z(e){let{children:t}=e;return(0,a.jsxs)("div",{className:"min-h-screen text-[#161B33] font-sans",children:[(0,a.jsx)(f,{}),(0,a.jsxs)("div",{className:"pl-24 flex flex-col min-h-screen transition-all duration-300",children:[(0,a.jsx)(E,{}),(0,a.jsx)("main",{className:"flex-1 p-6 md:p-8 overflow-x-hidden",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:t})})]})]})}},4362:function(e,t,s){s.d(t,{AuthProvider:function(){return c},a:function(){return u}});var a=s(7437),r=s(2265),l=s(1466),n=s(6943),i=s(6410),d=s(9376);let o=(0,r.createContext)({user:null,firebaseUser:null,loading:!0,logout:async()=>{}});function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),f=(0,d.useRouter)();(0,r.useEffect)(()=>{let e=(0,l.Aj)(i.I,async e=>{if(x(e),e)try{let t=await (0,n.QT)((0,n.JU)(i.db,"users",e.uid));t.exists()?c({id:t.id,...t.data()}):c(null)}catch(e){console.error("Error fetching user data:",e),c(null)}else c(null);h(!1)});return()=>e()},[]);let p=async()=>{await (0,l.w7)(i.I),c(null),x(null),f.push("/login")};return(0,a.jsx)(o.Provider,{value:{user:s,firebaseUser:u,loading:m,logout:p},children:t})}let u=()=>(0,r.useContext)(o)},6410:function(e,t,s){s.d(t,{I:function(){return i},V:function(){return o},db:function(){return d}});var a=s(738),r=s(1466),l=s(6943);let n=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyDL2GylAt2YVRSstEpp4hucbcqw7RuVk4o",authDomain:"internship-matching-app.firebaseapp.com",projectId:"internship-matching-app",messagingSenderId:"299078518812",appId:"1:299078518812:web:03ad34bb4323c497a677d9"}):(0,a.C6)()[0],i=(0,r.v0)(n),d=(0,l.ad)(n),o=new r.hJ},3448:function(e,t,s){s.d(t,{cn:function(){return l}});var a=s(1994),r=s(3335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}}]);