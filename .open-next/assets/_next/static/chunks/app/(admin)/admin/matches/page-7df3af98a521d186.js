(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8228],{1803:function(t,e,a){Promise.resolve().then(a.bind(a,3145))},44:function(t,e,a){"use strict";a.d(e,{Z:function(){return n}});let n=(0,a(8755).Z)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]])},1047:function(t,e,a){"use strict";a.d(e,{Z:function(){return n}});let n=(0,a(8755).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},2369:function(t,e,a){"use strict";a.d(e,{Z:function(){return n}});let n=(0,a(8755).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},3145:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return x}});var n=a(7437),s=a(7648),i=a(2265),r=a(3880),d=a(757),o=a(8711),c=a(6334),l=a(1817),u=a(2369),p=a(44),m=a(1047),h=a(6424);function x(){let[t,e]=(0,i.useState)([]),[a,x]=(0,i.useState)(!0),[g,f]=(0,i.useState)("all"),[y,b]=(0,i.useState)("");(0,i.useEffect)(()=>{!async function(){try{let t=await r.d.getAllMatches();e(t)}catch(t){console.error("Error fetching matches:",t)}finally{x(!1)}}()},[]);let v=t=>{switch(t){case"active":return(0,n.jsx)(o.C,{variant:"success",className:"bg-green-500 text-white",children:"進行中"});case"completed":return(0,n.jsx)(o.C,{variant:"outline",className:"text-gray-500 border-gray-300",children:"完了"});case"cancelled":return(0,n.jsx)(o.C,{variant:"error",className:"bg-red-100 text-red-500",children:"キャンセル"});default:return(0,n.jsx)(o.C,{variant:"outline",children:t})}},w=t.filter(t=>{if("all"!==g&&t.status!==g)return!1;if(y){var e,a,n;let s=y.toLowerCase(),i=(null===(e=t.studentName)||void 0===e?void 0:e.toLowerCase())||"",r=(null===(a=t.companyName)||void 0===a?void 0:a.toLowerCase())||"",d=(null===(n=t.jobTitle)||void 0===n?void 0:n.toLowerCase())||"";return i.includes(s)||r.includes(s)||d.includes(s)}return!0});return a?(0,n.jsx)("div",{className:"flex justify-center p-12",children:(0,n.jsx)(l.Z,{className:"animate-spin text-[#1E3A5F]"})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-[#1E3A5F]",children:"インターン実施状況"}),(0,n.jsxs)("p",{className:"text-gray-500",children:["成立したマッチング一覧と進捗状況（",w.length," 件）"]})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[(0,n.jsx)("input",{type:"text",placeholder:"学生名・企業名・求人で検索...",className:"border border-gray-300 rounded-lg px-4 py-2 text-sm w-full md:w-64 focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]",value:y,onChange:t=>b(t.target.value)}),(0,n.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg self-start",children:[(0,n.jsx)("button",{className:"px-4 py-1.5 rounded-md text-sm font-medium transition-colors ".concat("all"===g?"bg-white shadow text-[#1E3A5F]":"text-gray-500 hover:text-gray-700"),onClick:()=>f("all"),children:"すべて"}),(0,n.jsx)("button",{className:"px-4 py-1.5 rounded-md text-sm font-medium transition-colors ".concat("active"===g?"bg-white shadow text-[#1E3A5F]":"text-gray-500 hover:text-gray-700"),onClick:()=>f("active"),children:"進行中"}),(0,n.jsx)("button",{className:"px-4 py-1.5 rounded-md text-sm font-medium transition-colors ".concat("completed"===g?"bg-white shadow text-[#1E3A5F]":"text-gray-500 hover:text-gray-700"),onClick:()=>f("completed"),children:"完了"})]})]})]}),0===w.length?(0,n.jsx)(d.Z,{className:"p-12 text-center text-gray-500",children:"該当するマッチングはありません。"}):(0,n.jsx)("div",{className:"grid gap-4",children:w.map(t=>(0,n.jsx)(d.Z,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[v(t.status),(0,n.jsxs)("span",{className:"text-xs text-gray-400",children:["ID: ",t.id]})]}),(0,n.jsx)("h3",{className:"text-lg font-bold text-[#1E3A5F]",children:t.jobTitle}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-2 gap-x-8 text-sm text-gray-600 mt-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(u.Z,{size:16,className:"text-gray-400"}),(0,n.jsx)("span",{className:"font-medium",children:"学生:"})," ",t.studentName]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(p.Z,{size:16,className:"text-gray-400"}),(0,n.jsx)("span",{className:"font-medium",children:"企業:"})," ",t.companyName]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(m.Z,{size:16,className:"text-gray-400"}),(0,n.jsx)("span",{className:"font-medium",children:"開始日:"})," ",t.startDate?(0,h.WU)(t.startDate.toDate(),"yyyy/MM/dd"):"-"]}),t.endDate&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(m.Z,{size:16,className:"text-gray-400"}),(0,n.jsx)("span",{className:"font-medium",children:"終了日:"})," ",(0,h.WU)(t.endDate.toDate(),"yyyy/MM/dd")]})]})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(s.default,{href:"/admin/matches/".concat(t.id),children:(0,n.jsx)(c.z,{variant:"outline",children:"詳細を確認"})})})]})},t.id))})]})}},8711:function(t,e,a){"use strict";a.d(e,{C:function(){return r}});var n=a(7437),s=a(2265),i=a(3448);let r=(0,s.forwardRef)((t,e)=>{let{className:a,variant:s="default",...r}=t;return(0,n.jsx)("span",{ref:e,className:(0,i.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[s],a),...r})});r.displayName="Badge"},6334:function(t,e,a){"use strict";a.d(e,{z:function(){return d}});var n=a(7437),s=a(2265),i=a(3448),r=a(1817);let d=(0,s.forwardRef)((t,e)=>{let{className:a,variant:s="primary",size:d="md",isLoading:o,children:c,disabled:l,...u}=t;return(0,n.jsxs)("button",{ref:e,className:(0,i.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[d],a),disabled:l||o,...u,children:[o&&(0,n.jsx)(r.Z,{className:"mr-2 h-4 w-4 animate-spin"}),c]})});d.displayName="Button"},757:function(t,e,a){"use strict";a.d(e,{Z:function(){return r}});var n=a(7437),s=a(2265),i=a(3448);let r=(0,s.forwardRef)((t,e)=>{let{className:a,...s}=t;return(0,n.jsx)("div",{ref:e,className:(0,i.cn)("glass rounded-2xl p-6 transition-all duration-300",a),...s})});r.displayName="Card"},6410:function(t,e,a){"use strict";a.d(e,{I:function(){return d},V:function(){return c},db:function(){return o}});var n=a(738),s=a(1466),i=a(6943);let r=0===(0,n.C6)().length?(0,n.ZF)({apiKey:"AIzaSyDL2GylAt2YVRSstEpp4hucbcqw7RuVk4o",authDomain:"internship-matching-app.firebaseapp.com",projectId:"internship-matching-app",messagingSenderId:"299078518812",appId:"1:299078518812:web:03ad34bb4323c497a677d9"}):(0,n.C6)()[0],d=(0,s.v0)(r),o=(0,i.ad)(r),c=new s.hJ},1677:function(t,e,a){"use strict";async function n(t,e,a){try{let n=await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:t,subject:e,body:a})});if(!n.ok)return console.error("Failed to send email:",await n.text()),!1;return!0}catch(t){return console.error("Error sending email:",t),!1}}a.d(e,{C:function(){return n}})},3448:function(t,e,a){"use strict";a.d(e,{cn:function(){return i}});var n=a(1994),s=a(3335);function i(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];return(0,s.m6)((0,n.W)(e))}},3880:function(t,e,a){"use strict";a.d(e,{d:function(){return o}});var n=a(6410),s=a(6943),i=a(1437),r=a(1677);class d{async getUserEmail(t){try{let e=await (0,s.getDoc)((0,s.doc)(n.db,"users",t));if(e.exists())return e.data().email}catch(t){console.error("Error fetching user email:",t)}return null}async getStats(){try{let t=(0,s.hJ)(n.db,"users"),e=(0,s.hJ)(n.db,"companies"),a=(0,s.hJ)(n.db,"jobPostings"),i=(0,s.hJ)(n.db,"applications"),r=(0,s.hJ)(n.db,"matches"),d=await (0,s.Yp)((0,s.IO)(t,(0,s.ar)("role","==","student"))),o=await (0,s.Yp)(e),c=await (0,s.Yp)((0,s.IO)(a,(0,s.ar)("status","==","pending_approval"))),l=await (0,s.Yp)((0,s.IO)(a,(0,s.ar)("status","==","published"))),u=await (0,s.Yp)((0,s.IO)(i,(0,s.ar)("status","==","pending_admin"))),p=await (0,s.Yp)(r),m=await (0,s.Yp)((0,s.IO)(e,(0,s.ar)("isApproved","==",!1)));return{totalUsers:d.data().count,totalCompanies:o.data().count,pendingCompanies:m.data().count,pendingJobs:c.data().count,activeJobs:l.data().count,pendingApplications:u.data().count,totalMatches:p.data().count}}catch(t){throw console.error("AdminService.getStats error:",t),t}}async getPendingJobs(){try{let t=(0,s.IO)((0,s.hJ)(n.db,"jobPostings"),(0,s.ar)("status","==","pending_approval"),(0,s.Xo)("createdAt","asc"));return(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()}))}catch(e){var t;if("failed-precondition"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("index"))){console.warn("Composite index missing for getPendingJobs, falling back to unordered query. Create the index in Firebase Console.");let t=(0,s.IO)((0,s.hJ)(n.db,"jobPostings"),(0,s.ar)("status","==","pending_approval"));return(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()})).sort((t,e)=>{var a,n,s,i,r,d;return(null!==(r=null===(n=t.createdAt)||void 0===n?void 0:null===(a=n.toMillis)||void 0===a?void 0:a.call(n))&&void 0!==r?r:0)-(null!==(d=null===(i=e.createdAt)||void 0===i?void 0:null===(s=i.toMillis)||void 0===s?void 0:s.call(i))&&void 0!==d?d:0)})}throw e}}async getAllJobs(){let t=(0,s.IO)((0,s.hJ)(n.db,"jobPostings"),(0,s.Xo)("createdAt","desc"));return(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()}))}async approveJob(t){let e=(0,s.doc)(n.db,"jobPostings",t),a=await (0,s.getDoc)(e);if(!a.exists())return;let d=a.data();if(await (0,s.r7)(e,{status:"published",updatedAt:(0,s.Bt)()}),null==d?void 0:d.companyId){await i.B.createNotification(d.companyId,"求人が承認されました","求人「".concat(d.title,"」が公開されました。"),"job_approved_admin","/company/jobs/".concat(t));let e=await this.getUserEmail(d.companyId);e&&await (0,r.C)(e,"【Internship Match】求人公開のお知らせ","求人「".concat(d.title,"」が承認され、公開されました。\n\nマイページから確認できます。"))}}async rejectJob(t){let e=(0,s.doc)(n.db,"jobPostings",t),a=await (0,s.getDoc)(e),d=a.exists()?a.data():null;if(await (0,s.r7)(e,{status:"draft",updatedAt:(0,s.Bt)()}),null==d?void 0:d.companyId){await i.B.createNotification(d.companyId,"求人が差し戻されました","求人「".concat(d.title,"」の内容を確認してください。"),"system","/company/jobs/".concat(t));let e=await this.getUserEmail(d.companyId);e&&await (0,r.C)(e,"【Internship Match】求人差し戻しのお知らせ","求人「".concat(d.title,"」が差し戻されました。\n理由を確認し、内容を修正してください。"))}}async getAllCompanies(){return(await (0,s.PL)((0,s.hJ)(n.db,"companies"))).docs.map(t=>({userId:t.id,...t.data()}))}async approveCompany(t){await (0,s.r7)((0,s.doc)(n.db,"companies",t),{isApproved:!0,updatedAt:(0,s.Bt)()}),await i.B.createNotification(t,"企業アカウントが承認されました","アカウント審査が完了しました。求人の作成が可能です。","system","/company/dashboard");let e=await this.getUserEmail(t);e&&await (0,r.C)(e,"【Internship Match】企業アカウント承認のお知らせ","アカウント審査が完了しました。\n本日より求人の作成が可能になります。\n\nダッシュボードにログインしてご利用を開始してください。")}async revokeCompany(t){await (0,s.r7)((0,s.doc)(n.db,"companies",t),{isApproved:!1,updatedAt:(0,s.Bt)()})}async getPendingApplications(){try{let t=(0,s.IO)((0,s.hJ)(n.db,"applications"),(0,s.ar)("status","==","pending_admin"),(0,s.Xo)("createdAt","asc"));return(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()}))}catch(e){var t;if("failed-precondition"===e.code||(null===(t=e.message)||void 0===t?void 0:t.includes("index"))){console.warn("Composite index missing for getPendingApplications, falling back.");let t=(0,s.IO)((0,s.hJ)(n.db,"applications"),(0,s.ar)("status","==","pending_admin"));return(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()})).sort((t,e)=>{var a,n,s,i,r,d;return(null!==(r=null===(n=t.createdAt)||void 0===n?void 0:null===(a=n.toMillis)||void 0===a?void 0:a.call(n))&&void 0!==r?r:0)-(null!==(d=null===(i=e.createdAt)||void 0===i?void 0:null===(s=i.toMillis)||void 0===s?void 0:s.call(i))&&void 0!==d?d:0)})}throw e}}async getApplicationDetails(t){let e=await (0,s.getDoc)((0,s.doc)(n.db,"jobPostings",t.jobId)),a=await (0,s.getDoc)((0,s.doc)(n.db,"students",t.studentId)),i=await (0,s.getDoc)((0,s.doc)(n.db,"companies",t.companyId));return{job:e.exists()?e.data():null,student:a.exists()?a.data():null,company:i.exists()?i.data():null}}async approveApplication(t){}async getAllMatches(){try{let t=(0,s.IO)((0,s.hJ)(n.db,"matches"),(0,s.Xo)("createdAt","desc")),e=(await (0,s.PL)(t)).docs.map(t=>({id:t.id,...t.data()}));return await Promise.all(e.map(async t=>{let e=await (0,s.getDoc)((0,s.doc)(n.db,"students",t.studentId)),a=await (0,s.getDoc)((0,s.doc)(n.db,"companies",t.companyId)),i=await (0,s.getDoc)((0,s.doc)(n.db,"jobPostings",t.jobId));return{...t,studentName:e.exists()?e.data().name:"退会済みユーザー",companyName:a.exists()?a.data().name:"不明な企業",jobTitle:i.exists()?i.data().title:"削除された求人"}}))}catch(t){throw console.error("getAllMatches error:",t),t}}async getMatchEvaluations(t){try{let e=(0,s.IO)((0,s.hJ)(n.db,"evaluations"),(0,s.ar)("matchId","==",t));return(await (0,s.PL)(e)).docs.map(t=>({id:t.id,...t.data()}))}catch(t){return console.error(t),[]}}}let o=new d},1437:function(t,e,a){"use strict";a.d(e,{B:function(){return r}});var n=a(6410),s=a(6943);a(2265);class i{async markAsRead(t){let e=(0,s.doc)(n.db,"notifications",t);await (0,s.r7)(e,{read:!0,updatedAt:(0,s.Bt)()})}async markAllAsRead(t){let e=(0,s.IO)((0,s.hJ)(n.db,"notifications"),(0,s.ar)("userId","==",t),(0,s.ar)("read","==",!1)),a=await (0,s.PL)(e);if(a.empty)return;let i=(0,s.qs)(n.db);a.docs.forEach(t=>{i.update(t.ref,{read:!0,updatedAt:(0,s.Bt)()})}),await i.commit()}async createNotification(t,e,a,i,r){try{await (0,s.ET)((0,s.hJ)(n.db,"notifications"),{userId:t,title:e,message:a,type:i,link:r,read:!1,createdAt:(0,s.Bt)()})}catch(t){console.error("Error creating notification:",t)}}}let r=new i}},function(t){t.O(0,[287,8483,1442,8697,7648,6165,2971,2117,1744],function(){return t(t.s=1803)}),_N_E=t.O()}]);