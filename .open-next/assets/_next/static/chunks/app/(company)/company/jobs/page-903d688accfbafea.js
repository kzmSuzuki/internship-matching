(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1075],{2637:function(e,t,r){Promise.resolve().then(r.bind(r,326))},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(8755).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3578:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(8755).Z)("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},5868:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(8755).Z)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},8930:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(8755).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},326:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var a=r(7437),s=r(2265),n=r(6943),i=r(6410),l=r(4362),o=r(757),d=r(6334),c=r(8711),u=r(1817),h=r(9397),f=r(3578),m=r(5868),x=r(8930),p=r(7648),g=r(7735);function b(){let{user:e}=(0,l.a)(),[t,r]=(0,s.useState)([]),[b,y]=(0,s.useState)(!0),[v,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{!async function(){if(e)try{let t=await (0,n.getDoc)((0,n.doc)(i.db,"companies",e.id));t.exists()&&j(!0===t.data().isApproved);try{let t=(0,n.IO)((0,n.hJ)(i.db,"jobPostings"),(0,n.ar)("companyId","==",e.id),(0,n.Xo)("createdAt","desc")),a=(await (0,n.PL)(t)).docs.map(e=>({id:e.id,...e.data()}));r(a.filter(e=>!e.isDeleted))}catch(s){console.warn("Composite index missing for company jobs, falling back.");let t=(0,n.IO)((0,n.hJ)(i.db,"jobPostings"),(0,n.ar)("companyId","==",e.id)),a=(await (0,n.PL)(t)).docs.map(e=>({id:e.id,...e.data()})).filter(e=>!e.isDeleted);a.sort((e,t)=>{var r,a,s,n,i,l;let o=null!==(i=null===(a=e.createdAt)||void 0===a?void 0:null===(r=a.toMillis)||void 0===r?void 0:r.call(a))&&void 0!==i?i:0;return(null!==(l=null===(n=t.createdAt)||void 0===n?void 0:null===(s=n.toMillis)||void 0===s?void 0:s.call(n))&&void 0!==l?l:0)-o}),r(a)}}catch(e){console.error("Error fetching jobs:",e)}finally{y(!1)}}()},[e]);let w=async e=>{if(window.confirm("この求人を削除してもよろしいですか？取り消せません。"))try{console.log("Deleting job:",e),await (0,n.oe)((0,n.doc)(i.db,"jobPostings",e)),r(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Delete error:",t);try{console.log("Attempting soft delete for:",e),await (0,n.r7)((0,n.doc)(i.db,"jobPostings",e),{isDeleted:!0}),r(t=>t.filter(t=>t.id!==e));return}catch(e){console.error("Soft delete error:",e)}alert("削除に失敗しました: "+(t.message||"不明なエラー"))}},N=e=>{switch(e){case"published":return(0,a.jsx)(c.C,{variant:"success",children:"公開中"});case"pending_approval":return(0,a.jsx)(c.C,{variant:"warning",children:"承認待ち"});case"draft":return(0,a.jsx)(c.C,{variant:"outline",children:"下書き"});case"closed":return(0,a.jsx)(c.C,{variant:"error",className:"bg-gray-100 text-gray-500",children:"終了"});default:return(0,a.jsx)(c.C,{variant:"outline",children:e})}};return b?(0,a.jsx)("div",{className:"flex justify-center p-12",children:(0,a.jsx)(u.Z,{className:"animate-spin text-[#1E3A5F]"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-[#1E3A5F]",children:"求人管理"}),(0,a.jsx)("p",{className:"text-gray-500",children:"作成した求人の確認と編集ができます"})]}),v?(0,a.jsx)(p.default,{href:"/company/jobs/new",children:(0,a.jsxs)(d.z,{children:[(0,a.jsx)(h.Z,{size:18,className:"mr-2"}),"新規求人作成"]})}):(0,a.jsxs)(d.z,{disabled:!0,className:"opacity-50 cursor-not-allowed",children:[(0,a.jsx)(h.Z,{size:18,className:"mr-2"}),"新規求人作成"]})]}),!1===v&&(0,a.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-center gap-3",children:[(0,a.jsx)(f.Z,{className:"text-amber-600 flex-shrink-0",size:20}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"企業アカウントが承認されていないため、新規求人は作成できません。"}),(0,a.jsx)("p",{className:"text-xs text-amber-600",children:"管理者による承認をお待ちください。プロフィールを充実させておくと承認がスムーズです。"})]})]}),0===t.length?(0,a.jsx)(o.Z,{className:"p-12 text-center text-gray-500",children:(0,a.jsx)("p",{children:"まだ求人がありません。"})}):(0,a.jsx)("div",{className:"grid gap-4",children:t.map(e=>{var t;return(0,a.jsxs)(o.Z,{className:"p-6 flex flex-col sm:flex-row justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-[#1E3A5F]",children:e.title}),N(e.status)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[(null===(t=e.createdAt)||void 0===t?void 0:t.toDate)?(0,g.WU)(e.createdAt.toDate(),"yyyy/MM/dd"):"-"," 作成"]}),(0,a.jsx)("div",{className:"flex gap-2",children:e.requirements.slice(0,3).map((e,t)=>(0,a.jsx)(c.C,{variant:"outline",className:"text-xs bg-gray-50",children:e},t))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.default,{href:"/company/jobs/".concat(e.id),children:(0,a.jsx)(d.z,{variant:"outline",size:"sm",children:"詳細"})}),(0,a.jsx)(p.default,{href:"/company/jobs/".concat(e.id,"/edit"),children:(0,a.jsx)(d.z,{variant:"secondary",size:"sm",children:(0,a.jsx)(m.Z,{size:16})})}),(0,a.jsx)(d.z,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:()=>w(e.id),children:(0,a.jsx)(x.Z,{size:16})})]})]},e.id)})})]})}},8711:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var a=r(7437),s=r(2265),n=r(3448);let i=(0,s.forwardRef)((e,t)=>{let{className:r,variant:s="default",...i}=e;return(0,a.jsx)("span",{ref:t,className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[s],r),...i})});i.displayName="Badge"},6334:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var a=r(7437),s=r(2265),n=r(3448),i=r(1817);let l=(0,s.forwardRef)((e,t)=>{let{className:r,variant:s="primary",size:l="md",isLoading:o,children:d,disabled:c,...u}=e;return(0,a.jsxs)("button",{ref:t,className:(0,n.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[l],r),disabled:c||o,...u,children:[o&&(0,a.jsx)(i.Z,{className:"mr-2 h-4 w-4 animate-spin"}),d]})});l.displayName="Button"},757:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var a=r(7437),s=r(2265),n=r(3448);let i=(0,s.forwardRef)((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("glass rounded-2xl p-6 transition-all duration-300",r),...s})});i.displayName="Card"},4362:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return c},a:function(){return u}});var a=r(7437),s=r(2265),n=r(1466),i=r(6943),l=r(6410),o=r(9376);let d=(0,s.createContext)({user:null,firebaseUser:null,loading:!0,emailVerified:!1,logout:async()=>{},refreshUser:async()=>{}});function c(e){let{children:t}=e,[r,c]=(0,s.useState)(null),[u,h]=(0,s.useState)(null),[f,m]=(0,s.useState)(!0),[x,p]=(0,s.useState)(!1),g=(0,o.useRouter)(),b=async e=>{try{let t=await (0,i.getDoc)((0,i.doc)(l.db,"users",e.uid));t.exists()?c({id:t.id,...t.data()}):c(null)}catch(e){console.error("Error fetching user data:",e),c(null)}};(0,s.useEffect)(()=>{let e=(0,n.Aj)(l.I,async e=>{h(e),e?(p(e.emailVerified),await b(e)):(c(null),p(!1)),m(!1)});return()=>e()},[]);let y=async()=>{await (0,n.w7)(l.I),c(null),h(null),p(!1),g.push("/login")},v=async()=>{let e=l.I.currentUser;e&&(await e.reload(),p(e.emailVerified),await b(e))};return(0,a.jsx)(d.Provider,{value:{user:r,firebaseUser:u,loading:f,emailVerified:x,logout:y,refreshUser:v},children:t})}let u=()=>(0,s.useContext)(d)},6410:function(e,t,r){"use strict";r.d(t,{I:function(){return l},V:function(){return d},db:function(){return o}});var a=r(738),s=r(1466),n=r(6943);let i=0===(0,a.C6)().length?(0,a.ZF)({apiKey:"AIzaSyDL2GylAt2YVRSstEpp4hucbcqw7RuVk4o",authDomain:"internship-matching-app.firebaseapp.com",projectId:"internship-matching-app",messagingSenderId:"299078518812",appId:"1:299078518812:web:03ad34bb4323c497a677d9"}):(0,a.C6)()[0],l=(0,s.v0)(i),o=(0,n.ad)(i),d=new s.hJ},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}}},function(e){e.O(0,[287,8483,1442,8697,1787,7648,9814,2971,2117,1744],function(){return e(e.s=2637)}),_N_E=e.O()}]);