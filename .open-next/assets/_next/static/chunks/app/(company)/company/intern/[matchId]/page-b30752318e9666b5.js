(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[701],{4746:function(e,t,a){Promise.resolve().then(a.bind(a,4399))},1047:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(8755).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},1671:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(8755).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3417:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(8755).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},4399:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),r=a(2265),n=a(4362),l=a(4279),i=a(6943),c=a(6410),d=a(757),o=a(6334),u=a(8711),x=a(1817),h=a(1671),m=a(1047),p=a(3417),f=a(7735);function y(e){let{params:t}=e,{matchId:a}=(0,r.use)(t),{user:y}=(0,n.a)(),[g,b]=(0,r.useState)(null),[v,j]=(0,r.useState)(null),[w,N]=(0,r.useState)([]),[E,A]=(0,r.useState)(!0),[C,k]=(0,r.useState)(null),[F,I]=(0,r.useState)(0),[R,S]=(0,r.useState)(""),[z,B]=(0,r.useState)(!1),[M,Z]=(0,r.useState)(null),[D,J]=(0,r.useState)(""),[U,P]=(0,r.useState)(!1);(0,r.useEffect)(()=>{!async function(){if(y)try{let e=await l.i.getMatch(a);if(!e||e.companyId!==y.id)throw Error("Match not found or unauthorized");b(e);let t=await (0,i.QT)((0,i.JU)(c.db,"students",e.studentId));t.exists()?j(t.data()):j({name:"Unknown",userId:e.studentId});let s=await l.i.getReports(a);if(N(s),"completed"===e.status){let e=await l.i.getEvaluation(a,y.id);k(e)}}catch(e){console.error("Error fetching data:",e)}finally{A(!1)}}()},[a,y]);let L=async()=>{if(g&&confirm("このインターンシップを終了しますか？\n終了すると、学生への評価が可能になります。"))try{await l.i.completeInternship(g.id);let e=await l.i.getMatch(g.id);b(e)}catch(e){console.error(e),alert("ステータス更新に失敗しました")}},_=async e=>{if(D){P(!0);try{if(await l.i.addCompanyComment(e,D),g){let e=await l.i.getReports(g.id);N(e)}Z(null),J("")}catch(e){console.error(e),alert("コメントの送信に失敗しました")}finally{P(!1)}}},T=async e=>{if(e.preventDefault(),y&&g&&v&&confirm("評価を送信しますか？送信後は変更できません。")){B(!0);try{await l.i.submitEvaluation(g.id,y.id,v.userId,F,R);let e=await l.i.getEvaluation(g.id,y.id);k(e)}catch(e){console.error(e),alert("評価の送信に失敗しました")}finally{B(!1)}}};return E?(0,s.jsx)("div",{className:"flex justify-center p-12",children:(0,s.jsx)(x.Z,{className:"animate-spin"})}):g?(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center bg-[#1E3A5F] text-white p-6 rounded-xl shadow-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h1",{className:"text-xl font-bold",children:null==v?void 0:v.name}),(0,s.jsx)("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded",children:null==v?void 0:v.university})]}),(0,s.jsxs)("p",{className:"text-sm opacity-90",children:["期間: ",g.startDate?(0,f.WU)(g.startDate.toDate(),"yyyy/MM/dd"):"-",g.endDate?" ~ ".concat((0,f.WU)(g.endDate.toDate(),"yyyy/MM/dd")):" ~ 進行中"]})]}),(0,s.jsx)("div",{children:"active"===g.status?(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(u.C,{variant:"success",className:"bg-[#48BB78] text-white border-none",children:"進行中"}),(0,s.jsxs)(o.z,{size:"sm",className:"bg-white text-[#1E3A5F] hover:bg-white/90",onClick:L,children:[(0,s.jsx)(h.Z,{size:16,className:"mr-1"}),"インターンを終了する"]})]}):(0,s.jsx)(u.C,{variant:"outline",className:"text-white border-white",children:"完了"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)("h2",{className:"text-lg font-bold text-[#1E3A5F]",children:"日報一覧"})}),0===w.length?(0,s.jsx)(d.Z,{className:"p-8 text-center text-gray-500",children:"まだ日報が提出されていません。"}):(0,s.jsx)("div",{className:"space-y-4",children:w.map(e=>(0,s.jsxs)(d.Z,{className:"p-5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3 border-b pb-2",children:[(0,s.jsx)(m.Z,{size:16,className:"text-gray-400"}),(0,s.jsx)("span",{className:"font-bold text-[#1E3A5F]",children:(0,f.WU)(e.date.toDate(),"yyyy/MM/dd")})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-400 block",children:"業務内容"}),(0,s.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:e.content})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-400 block",children:"学んだこと"}),(0,s.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:e.learning})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-400 block",children:"明日の目標"}),(0,s.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:e.nextGoals})]}),(0,s.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg mt-2 border border-gray-100",children:e.companyComment?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-blue-800 font-bold mb-1 text-xs",children:[(0,s.jsx)(p.Z,{size:12}),"フィードバック済み"]}),(0,s.jsx)("p",{className:"text-sm text-blue-900",children:e.companyComment})]}):M===e.id?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("textarea",{className:"w-full text-sm border rounded p-2",value:D,onChange:e=>J(e.target.value),placeholder:"フィードバックを入力..."}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(o.z,{size:"sm",variant:"secondary",onClick:()=>Z(null),children:"キャンセル"}),(0,s.jsx)(o.z,{size:"sm",onClick:()=>_(e.id),isLoading:U,children:"送信"})]})]}):(0,s.jsx)(o.z,{size:"sm",variant:"outline",className:"w-full text-xs text-gray-500 hover:text-[#1E3A5F]",onClick:()=>{Z(e.id),J("")},children:"+ フィードバックを書く"})})]})]},e.id))})]}),(0,s.jsx)("div",{className:"space-y-6",children:"completed"===g.status&&(0,s.jsxs)(d.Z,{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-4 text-[#1E3A5F]",children:"学生評価"}),C?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-[#48BB78]/10 text-center py-4 rounded-lg",children:[(0,s.jsx)("span",{className:"block text-xs text-gray-500",children:"評価完了"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-[#2F855A]",children:"送信済み"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-400",children:"スコア"}),(0,s.jsx)("div",{className:"flex text-yellow-500",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)("span",{className:t<C.score?"text-yellow-500":"text-gray-300",children:"★"},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-xs text-gray-400",children:"コメント"}),(0,s.jsx)("p",{className:"text-sm",children:C.comment})]})]}):(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"インターンシップが終了しました。 学生への最終評価を入力してください。"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"評価スコア (1-5)"}),(0,s.jsxs)("select",{className:"w-full border rounded p-2",value:F,onChange:e=>I(Number(e.target.value)),required:!0,children:[(0,s.jsx)("option",{value:"0",children:"選択してください"}),(0,s.jsx)("option",{value:"5",children:"5 - 非常に優秀"}),(0,s.jsx)("option",{value:"4",children:"4 - 優秀"}),(0,s.jsx)("option",{value:"3",children:"3 - 標準的"}),(0,s.jsx)("option",{value:"2",children:"2 - 改善の余地あり"}),(0,s.jsx)("option",{value:"1",children:"1 - 期待を下回る"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"コメント"}),(0,s.jsx)("textarea",{className:"w-full border rounded p-2 min-h-[100px]",value:R,onChange:e=>S(e.target.value),required:!0,placeholder:"学生へのフィードバックや応援メッセージ..."})]}),(0,s.jsx)(o.z,{type:"submit",className:"w-full",isLoading:z,disabled:0===F,children:"評価を送信する"})]})]})})]})]}):(0,s.jsx)("div",{className:"p-12 text-center",children:"データが見つかりません"})}},8711:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var s=a(7437),r=a(2265),n=a(3448);let l=(0,r.forwardRef)((e,t)=>{let{className:a,variant:r="default",...l}=e;return(0,s.jsx)("span",{ref:t,className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",{default:"bg-[#1E3A5F]/10 text-[#161B33]",success:"bg-[#48BB78]/10 text-[#48BB78]",warning:"bg-[#ED8936]/10 text-[#ED8936]",error:"bg-[#F56565]/10 text-[#F56565]",outline:"border border-gray-200 text-gray-500"}[r],a),...l})});l.displayName="Badge"},6334:function(e,t,a){"use strict";a.d(t,{z:function(){return i}});var s=a(7437),r=a(2265),n=a(3448),l=a(1817);let i=(0,r.forwardRef)((e,t)=>{let{className:a,variant:r="primary",size:i="md",isLoading:c,children:d,disabled:o,...u}=e;return(0,s.jsxs)("button",{ref:t,className:(0,n.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-[#1E3A5F]/50 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-gradient-to-r from-[#161B33] to-[#142841] text-white shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 border border-white/10",secondary:"glass-button text-[#1E3A5F] bg-white/40 hover:bg-white/60",outline:"glass-button border border-[#1E3A5F]/30 text-[#1E3A5F] hover:bg-[#1E3A5F]/5",ghost:"text-[#1E3A5F] hover:bg-[#1E3A5F]/10",danger:"glass-button bg-gradient-to-r from-[#F56565] to-[#E53E3E] text-white border-0"}[r],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[i],a),disabled:o||c,...u,children:[c&&(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),d]})});i.displayName="Button"},757:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(7437),r=a(2265),n=a(3448);let l=(0,r.forwardRef)((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("glass rounded-2xl p-6 transition-all duration-300",a),...r})});l.displayName="Card"},4362:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return o},a:function(){return u}});var s=a(7437),r=a(2265),n=a(1466),l=a(6943),i=a(6410),c=a(9376);let d=(0,r.createContext)({user:null,firebaseUser:null,loading:!0,logout:async()=>{}});function o(e){let{children:t}=e,[a,o]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[h,m]=(0,r.useState)(!0),p=(0,c.useRouter)();(0,r.useEffect)(()=>{let e=(0,n.Aj)(i.I,async e=>{if(x(e),e)try{let t=await (0,l.QT)((0,l.JU)(i.db,"users",e.uid));t.exists()?o({id:t.id,...t.data()}):o(null)}catch(e){console.error("Error fetching user data:",e),o(null)}else o(null);m(!1)});return()=>e()},[]);let f=async()=>{await (0,n.w7)(i.I),o(null),x(null),p.push("/login")};return(0,s.jsx)(d.Provider,{value:{user:a,firebaseUser:u,loading:h,logout:f},children:t})}let u=()=>(0,r.useContext)(d)},6410:function(e,t,a){"use strict";a.d(t,{I:function(){return i},V:function(){return d},db:function(){return c}});var s=a(738),r=a(1466),n=a(6943);let l=0===(0,s.C6)().length?(0,s.ZF)({apiKey:"AIzaSyDL2GylAt2YVRSstEpp4hucbcqw7RuVk4o",authDomain:"internship-matching-app.firebaseapp.com",projectId:"internship-matching-app",messagingSenderId:"299078518812",appId:"1:299078518812:web:03ad34bb4323c497a677d9"}):(0,s.C6)()[0],i=(0,r.v0)(l),c=(0,n.ad)(l),d=new r.hJ},3448:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var s=a(1994),r=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}},4279:function(e,t,a){"use strict";a.d(t,{i:function(){return l}});var s=a(6410),r=a(6943);class n{async createReport(e,t,a,n,l,i){try{return(await (0,r.ET)((0,r.hJ)(s.db,"dailyReports"),{matchId:t,studentId:e,date:r.EK.fromDate(i),content:a,learning:n,nextGoals:l,createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()})).id}catch(e){throw console.error("createReport error:",e),e}}async getReports(e){try{let t=(0,r.IO)((0,r.hJ)(s.db,"dailyReports"),(0,r.ar)("matchId","==",e),(0,r.Xo)("date","desc"));return(await (0,r.PL)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("getReports error:",e),e}}async addCompanyComment(e,t){try{let a=(0,r.JU)(s.db,"dailyReports",e);await (0,r.r7)(a,{companyComment:t,updatedAt:(0,r.Bt)()})}catch(e){throw console.error("addCompanyComment error:",e),e}}async getMatch(e){try{let t=await (0,r.QT)((0,r.JU)(s.db,"matches",e));if(t.exists())return{id:t.id,...t.data()};return null}catch(e){throw console.error("getMatch error:",e),e}}async completeInternship(e){try{await (0,r.r7)((0,r.JU)(s.db,"matches",e),{status:"completed",endDate:(0,r.Bt)()})}catch(e){throw console.error("completeInternship error:",e),e}}async submitEvaluation(e,t,a,n,l){try{await (0,r.ET)((0,r.hJ)(s.db,"evaluations"),{matchId:e,fromId:t,toId:a,score:n,comment:l,createdAt:(0,r.Bt)()})}catch(e){throw console.error("submitEvaluation error:",e),e}}async getEvaluation(e,t){try{let a=(0,r.IO)((0,r.hJ)(s.db,"evaluations"),(0,r.ar)("matchId","==",e),(0,r.ar)("fromId","==",t)),n=await (0,r.PL)(a);if(!n.empty)return{id:n.docs[0].id,...n.docs[0].data()};return null}catch(e){throw console.error("getEvaluation error:",e),e}}}let l=new n}},function(e){e.O(0,[287,483,137,442,94,814,971,117,744],function(){return e(e.s=4746)}),_N_E=e.O()}]);